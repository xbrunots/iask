(window.webpackJsonp=window.webpackJsonp||[]).push([["topicData"],{"0+nS":function(e,t,i){"use strict";var s;i.d(t,"a",(function(){return s})),function(e){e.SysTag="SysTag",e.UserQuery="UserQuery"}(s||(s={}))},"2Sqd":function(e,t,i){"use strict";i.r(t),i.d(t,"FeedType",(function(){return r.a})),i.d(t,"FollowState",(function(){return o.a})),i.d(t,"ResizeServiceImage",(function(){return p})),i.d(t,"TopicSourceNameEnum",(function(){return n.a})),i.d(t,"TopicDataActions",(function(){return g.a})),i.d(t,"TopicDataConnector",(function(){return se})),i.d(t,"TopicDataReducer",(function(){return ne})),i.d(t,"TopicsFetchState",(function(){return s})),i.d(t,"ToolingInfo",(function(){return ce})),i.d(t,"clearTopicsCache",(function(){return a.a})),i.d(t,"registerTopicsCacheAppErrorCallback",(function(){return a.e})),i.d(t,"InterestsSearchServiceClient",(function(){return c.a})),i.d(t,"WindowsTopicDataProvider",(function(){return ae}));var s,r=i("0+nS"),o=i("uH2+"),n=i("623N");!function(e){e[e.InProgress=0]="InProgress",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(s||(s={}));var a=i("6urM"),c=i("MMvm"),d=i("ADRF"),l=i("SNCn");var u;!function(e){e[e.LetterBox=1]="LetterBox",e[e.Scale=2]="Scale",e[e.Stretch=3]="Stretch",e[e.Crop=4]="Crop",e[e.FocalCrop=5]="FocalCrop",e[e.TmxResize=6]="TmxResize",e[e.AppExResize=7]="AppExResize",e[e.CustomCrop=8]="CustomCrop"}(u||(u={}));class p{constructor(e,t=0,i=0){this.url=e,this.height=t,this.width=i,this.mode=u.Crop,this.quality=60,this.url=(this.url||"").replace(/http:/,"https:").replace(/\?.*/,"")}static from(e){return e?new p(e.url,e.height,e.width):null}get src(){const e=[];return e.push({key:"w",value:Object(l.a)(this.width)}),e.push({key:"h",value:Object(l.a)(this.height)}),e.push({key:"m",value:Object(l.a)(this.mode)}),e.push({key:"q",value:Object(l.a)(this.quality)}),this.url+"?"+d.a.keyValueArrayToQueryString(e)}resizeTo(e,t){return this.width=t,this.height=e,this}}var h,g=i("FaCY"),f=i("D57K"),v=i("HxRh"),b=i("rvYQ"),m=i("I6Lx"),y=i("ax+D"),O=i("dTwT");!function(e){e.InterestsNeedRefresh="interests-need-refresh"}(h||(h={}));var j,T=i("tERu"),w=i("rPvf"),S=i("8X6I"),I=i("SSDD"),C=i("k112"),R=i("KUTD"),F=i("k3mM"),k=i("C8K2");!function(e){e.topicCardBackupImageUrl="https://img-s-msn-com.akamaized.net/tenant/amp/entityid/AAtCmK3.img";e.TopicCardStandardDimensions={borderWidth:4,height:250,width:250,gutterSize:k.a},e.TopicCardImageStandardDimensions={height:242,width:242}}(j||(j={}));const E="feeds";var A=i("y+Kz"),M=i("6ADy"),U=i("msIb"),D=i("KETb"),L=i("ac9z"),P=i("fuIx"),q=i("e8jz"),x=i("CzGr"),N=i("Zsg4"),V=i("kN1G"),Q=i("/+Un"),H=i("OTRt"),K=i("hDMs"),$=i("MptA"),G=i("NuVg"),B=i("tMmC");class W{static TranslateToTopicGroups(e,t){if(B.a.logObjects(e),!y.a.isDefined(e)||!W.isValidCompositeCardResponse(e.value))throw new Error("Topics OneService response schema validation error: no valid topic groups found!");const i={topicGroupIds:[],topicGroupMap:{},topicMap:{}};return e.value[0].subCards.forEach(e=>{if(W.isValidTopicGroup(e,!0)){const s=W.getTopics(e,t);y.a.arrayHasData(s)&&(s.forEach(e=>{i.topicMap[e.id]=e}),i.topicGroupMap[e.id]={id:e.id,nextPageUrl:e.nextPageUrl,title:e.title,topicIds:s.map(e=>e.id)},i.topicGroupIds.push(e.id))}}),i}static TranslateToRecommendedTopics(e){if(B.a.logObjects(e),!y.a.isDefined(e)&&e.value)throw new Error("Topics OneService response schema validation error: no valid topic group found!");return e.value.map(e=>{const t=Object.assign(Object.assign({},e),{name:e.title,feedType:null});return W.getTopic(t,null)})}static TranslateSingleTopicResponseToTopic(e){if(!y.a.isDefined(e)||!W.isValidCompositeCardResponse(e.value))throw new Error("Topics OneService response schema validation error: no valid followed topics found!");const t=e.value[0].subCards;return W.getTopic(t[0],null)}static TranslateToFollowedTopics(e){if(B.a.logObjects(e),!y.a.isDefined(e)||!y.a.arrayHasData(e.value))throw new Error("Topics OneService response schema validation error: no valid followed topics found!");const t=e.value,i={};return t.forEach(e=>{if(e&&e.id){const t={};t[e.id]=[{followState:"followed"}],e.title&&(e.name=e.title,delete e.title);const s=W.getTopic(e,t);i[s.id]=s}}),i}static getTopic(e,t,i){if(!Object($.a)(e.id)||!Object($.a)(e.name))return null;let s;if(s=t&&y.a.arrayHasData(t[e.id])?t[e.id][0]:{followState:o.a.Unfollowed},!y.a.isDefined(s))return null;i||(i=j.TopicCardImageStandardDimensions);const r=e.image,n=r&&r.url?p.from(r).resizeTo(i.height,i.width).src:j.topicCardBackupImageUrl;return{id:e.id,name:e.name,followState:s.followState===o.a.Unfollowed||s.followState===o.a.None?o.a.Unfollowed:o.a.Followed,imgSrc:n,href:K.a.generateTopicLink(e.id,e.name),feedType:e.feedType,canonicalName:e.canonicalName,isInferred:e.isInferred,branding:e.branding,locale:e.locale}}static getTopics(e,t){const i=[];return e.subCards.forEach(s=>{const r=W.getTopic(s,e.metadata,t);i.push(r)}),i}static isValidTopicGroup(e,t){return(!t||Object($.a)(e.id))&&!Object(G.a)(e.metadata)&&y.a.arrayHasData(e.subCards)}static isValidCompositeCardResponse(e){return y.a.arrayHasData(e)&&y.a.arrayHasData(e[0].subCards)}}var z=i("YI90");class J{constructor(e,t=Object(M.b)(),i){this.fetchImpl=e,this.serviceURL=t,this.useEnterpriseCompliance=i}getFollowedTopics(e,t){var i;return Object(f.a)(this,void 0,void 0,(function*(){const s=yield this.getRequestInit(),r=yield this.getCommonParams(E),o=Object(P.b)()?null:Object(L.b)();if((this.useEnterpriseCompliance||Object(V.j)())&&!(null===(i=null==s?void 0:s.headers)||void 0===i?void 0:i[A.s.authorization]))return{};const n=[...r,{key:A.t.queryType,value:"MyFeed"},{key:A.t.top,value:"1000"},{key:"allTopics",value:"true"},{key:"rndId",value:e?Object(z.a)(0,1e3).toString():null},{key:L.a,value:o?o.toString():null},{key:A.t.responseSchema,value:H.a.CardView}];t&&n.push({key:"$orderby",value:"createdDateTime desc"});const a=this.getLocationData();a&&!Object(P.b)()&&n.push({key:A.t.location,value:a});const c=Object(M.c)("msn/topics",this.serviceURL);this.appendQs(n,c);const d=yield this.sendRequest(decodeURIComponent(c.href),s,"getUserTopics");return W.TranslateToFollowedTopics(d)}))}getRecommendedTopics(){return Object(f.a)(this,void 0,void 0,(function*(){const e=yield this.getRequestInit(),t=[...yield this.getCommonParams(E),{key:A.t.queryType,value:"recommendations"},{key:A.t.select,value:"id,title,image"}],i=Object(M.c)("msn/topics/me/recommendations",this.serviceURL);this.appendQs(t,i);const s=yield this.sendRequest(decodeURIComponent(i.href),e,"getRecommendedTopics");return W.TranslateToRecommendedTopics(s)}))}getRelatedTopics(e,t){return Object(f.a)(this,void 0,void 0,(function*(){if(!e)return Promise.reject();const i=Object(M.c)("news/topics/{id}/related".replace("{id}",e.id),this.serviceURL),s=yield this.getCommonParams(E);t&&t>0&&s.push({key:A.t.top,value:t.toString()}),this.appendQs(s,i);const r=yield this.getRequestInit(),o=yield this.sendRequest(decodeURIComponent(i.href),r,"getRelatedTopics");return o&&0===o.length?o:W.TranslateToRecommendedTopics(o)}))}getTopics(e,t){return Object(f.a)(this,void 0,void 0,(function*(){const i=yield this.getRequestInit(),s=yield this.getCommonParams(E),r=t||[...s,{key:A.t.queryType,value:"Discover"},{key:A.t.top,value:"100"},{key:A.t.select,value:"id,name,image,feedType,canonicalName,branding"}],o=this.getLocationData();o&&r.push({key:A.t.location,value:o});const n=Object(M.c)("msn/topics",this.serviceURL);this.appendQs(r,n);const a=yield this.sendRequest(decodeURIComponent(n.href),i,"getTopicGroups");return W.TranslateToTopicGroups(a,e)}))}getTopic(e){return Object(f.a)(this,void 0,void 0,(function*(){const t=yield this.getRequestInit(),i=[...yield this.getCommonParams(E),{key:A.t.ids,value:e}],s=this.getLocationData();s&&i.push({key:A.t.location,value:s});const r=Object(M.c)("msn/topics",this.serviceURL);this.appendQs(i,r);const o=yield this.sendRequest(decodeURIComponent(r.href),t,"getTopic");return W.TranslateSingleTopicResponseToTopic(o)}))}updateTopicFollowingState(e,t,i){return Object(f.a)(this,void 0,void 0,(function*(){const s=Object(M.c)("Graph/Actions",this.serviceURL),r=yield this.getRequestInit(),o=yield this.getCommonParams(E),n=this.getLocationData();if(n&&o.push({key:A.t.location,value:n}),t){const t={actionType:"Follow"};(null==e?void 0:e.id)?t.targetId=null==e?void 0:e.id:i&&(t.definitionName=i),r.method="POST",r.headers["Content-Type"]="text/json",r.body=JSON.stringify(t),this.appendQs(o,s)}else{const t={key:A.t.filter,value:`actionType eq 'Follow' and (targetId eq '${null==e?void 0:e.id}')`};r.method="DELETE";const i=[t,...o];this.appendQs(i,s)}return yield this.sendRequest(decodeURIComponent(s.href),r,"updateTopicFollowingState")}))}restoreDefaultTopics(){return Object(f.a)(this,void 0,void 0,(function*(){const e=Object(M.c)("Graph/Actions",this.serviceURL),t=yield this.getRequestInit();t.method="DELETE";const i=[...yield this.getCommonParams(E),{key:A.t.filter,value:"actionType eq 'Follow'"}];this.appendQs(i,e);return yield this.sendRequest(decodeURIComponent(e.href),t,"restoreDefaultTopics")}))}getLocationData(){const e=Object(m.a)();return e.ClientSettings&&e.ClientSettings.geo_lat&&e.ClientSettings.geo_long?`${e.ClientSettings.geo_lat}|${e.ClientSettings.geo_long}`:null}getCommonParams(e){return Object(f.a)(this,void 0,void 0,(function*(){if(Object(P.b)())return this.getSapphireQueryParams();let t=!0;const i=yield this.isUserSignedIn();return m.b.IsBlendedEnterprise&&(e="entnewsntp",t=!1),i?U.a.getOneServiceParamsWithAuth(b.a.UserId,e,t):U.a.getOneServiceParamsWithoutAuth(b.a.UserId,e,t,null,!1,this.useEnterpriseCompliance)}))}getSapphireQueryParams(){const e=U.a.getOneServiceNonDynamicParamsWithoutAuth(E),t=Object(q.b)();return t&&(e.push({key:A.t.market,value:t.market}),e.push({key:A.t.fdhead,value:t.features}),e.push({key:A.t.activityId,value:t.activityId}),t.latitude&&t.longitude&&e.push({key:A.t.location,value:`${t.latitude}|${t.longitude}`})),e}getRequestInit(e=null){return Object(f.a)(this,void 0,void 0,(function*(){return null==e&&(e={method:"GET"}),(yield this.isUserSignedIn())&&(e.credentials="include"),e.headers=Object(P.b)()?yield Object(x.a)():yield U.a.getOneServiceHeaders(this.useEnterpriseCompliance),e}))}isUserSignedIn(){return Object(f.a)(this,void 0,void 0,(function*(){const e=Object(m.a)().UserIsSignedIn;if(void 0!==e)return e;return(yield Object(Q.d)())===T.c.SignedIn}))}sendRequest(e,t,i){return Object(f.a)(this,void 0,void 0,(function*(){return Object(P.b)()?yield this.sapphireRequest(decodeURIComponent(e),t):yield this.networkRequest(decodeURIComponent(e),t,i)}))}sapphireRequest(e,t){return Object(f.a)(this,void 0,void 0,(function*(){const i={url:e,headers:t.headers,body:t.body,refresh:!0};let s;switch(t.method){case"POST":s=yield Object(N.j)(i);break;case"DELETE":s=yield Object(N.a)(i);break;default:s=yield Object(N.c)(i)}return JSON.parse(s||"{}")}))}networkRequest(e,t,i){return Object(f.a)(this,void 0,void 0,(function*(){const s=yield Object(D.b)(()=>Object(f.a)(this,void 0,void 0,(function*(){return yield this.fetchImpl(e,t)})),i);if(!s.ok)throw Error(s.statusText);return 204===s.status?[]:s.json()}))}appendQs(e,t){e.forEach(e=>{e.value&&t.searchParams.set(e.key,e.value)})}getMockWorkTopics(){return{"@odata.context":"http://api.msn.com/msn/topics/me/$metadata#work",value:[{id:"Y_d659302d-5ac4-460a-9baa-8c8684761110",title:"Microsoft In The News",image:{width:292,height:342,quality:98,url:"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AAtK2OS.img",title:"Travel News large interest image"}},{id:"Y_a952481b-5929-4b40-83be-f2bc6edf43dd",title:"Technology",image:{width:292,height:342,quality:98,url:"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AAtJSnh.img",title:"Weather large interest image"}}]}}}class _{constructor(e){this.servicesMap=e}getFollowedTopics(e,t){return Object(f.a)(this,void 0,void 0,(function*(){const i=[],s=Object.entries(this.servicesMap).map(([s,r])=>r.getFollowedTopics(e,t).then(e=>(Object.values(e).forEach(e=>{e.apiSource={id:s,baseUrl:r.serviceURL}}),e)).catch(e=>(i.push({error:e,serviceId:s}),null)));return Promise.all(s).then(e=>{if((null==i?void 0:i.length)===Object.keys(this.servicesMap).length)throw this.combineErrors(i);return Object.assign({},...e.filter(e=>e))})}))}getRecommendedTopics(){return Object(f.a)(this,void 0,void 0,(function*(){const e=[],t=Object.entries(this.servicesMap).map(([t,i])=>i.getRecommendedTopics().then(e=>(e.forEach(e=>{e.apiSource={id:t,baseUrl:i.serviceURL}}),e)).catch(i=>(e.push({error:i,serviceId:t}),null)));return Promise.all(t).then(t=>{if((null==e?void 0:e.length)===Object.keys(this.servicesMap).length)throw this.combineErrors(e);return t.filter(e=>e).reduce((e,t)=>e.concat(t),[])})}))}getRelatedTopics(e,t){return Object(f.a)(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.apiSource))return;const{id:i}=e.apiSource,s=this.servicesMap[i];return s?s.getRelatedTopics(e,t).then(e=>(e.forEach(e=>{e.apiSource={id:i,baseUrl:s.serviceURL}}),e)):void 0}))}getTopics(e,t){return Object(f.a)(this,void 0,void 0,(function*(){const i=[],s=Object.entries(this.servicesMap).map(([s,r])=>r.getTopics(e,t).then(e=>(Object.values(e.topicMap).forEach(e=>{e.apiSource={id:s,baseUrl:r.serviceURL}}),e)).catch(e=>(i.push({error:e,serviceId:s}),null)));return Promise.all(s).then(e=>{if((null==i?void 0:i.length)===Object.keys(this.servicesMap).length)throw this.combineErrors(i);const t=e.filter(e=>e);return{topicGroupIds:t.map(e=>e.topicGroupIds).reduce((e,t)=>e.concat(t),[]),topicGroupMap:Object.assign({},...t.map(e=>e.topicGroupMap)),topicMap:Object.assign({},...t.map(e=>e.topicMap))}})}))}getTopic(e){return Object(f.a)(this,void 0,void 0,(function*(){const t=[],i=Object.entries(this.servicesMap).map(([i,s])=>s.getTopic(e).then(e=>(e.apiSource={id:i,baseUrl:s.serviceURL},e)).catch(e=>(t.push({error:e,serviceId:i}),null)));return Promise.all(i).then(e=>{if((null==t?void 0:t.length)===Object.keys(this.servicesMap).length)throw this.combineErrors(t);return e.reduce((e,t)=>e||t)})}))}updateTopicFollowingState(e,t,i){return Object(f.a)(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.apiSource)){const s=this.servicesMap[n.a.consumer];return null==s?void 0:s.updateTopicFollowingState(e,t,i)}const{id:s}=e.apiSource,r=this.servicesMap[s];if(r)return r.updateTopicFollowingState(e,t,i)}))}restoreDefaultTopics(){return Object(f.a)(this,void 0,void 0,(function*(){const e=Object.entries(this.servicesMap).map(([e,t])=>t.restoreDefaultTopics());return Promise.all(e)}))}combineErrors(e){const t=e.filter(e=>e).reduce((e,t)=>{var i;return`${e} serviceId: ${t.serviceId}, Message: ${null===(i=t.error)||void 0===i?void 0:i.message};`},"");return new Error(t)}}var X=i("XLvf"),Y=i("1w6q"),Z=i("u5KZ"),ee=i("HDSB"),te=i("PZnQ"),ie=i("pMIE");class se extends Y.a{constructor(e,t,i,s,r,o,c){super(e,t,i,s,r,o,c),this.fetchedAllFollowedTopics=!1,this.fetchedAllRecommendedTopics=!1,this.fetchedAllTopics=!1;const d=Object(ee.a)()?window.fetch.bind(window):fetch;if(o&&o.useMultiTopicSource){const e={};e[n.a.work]=new J(d,b.a.EnterpriseServiceUrlBase,!0),e[n.a.consumer]=new J(d,b.a.ServiceUrlBase,!1),this.serviceClient=new _(e)}else this.serviceClient=new J(d);Object(ee.a)()&&(this.followedTopicsListKey=Object(a.b)("followedTopics")),this.trackAppErrorEventCallback=Z.a?e=>Z.a.sendAppErrorEvent(e):null;const l=Object(m.a)();this.useUserCreatedOrder=l.CurrentFlights.indexOf("prg-navfr-t")>-1,l.IsBlendedEnterprise&&(this.cardProvider=new w.a({initialRequest:{start:0,count:5,timeoutMs:3e3,disableFlatViewResponse:!0,select:"id",contentType:"article,video,slideshow,webcontent"}}))}registerTrackAppErrorEventCallback(e){this.trackAppErrorEventCallback=e}followTopic(e,t,i){return Object(f.a)(this,void 0,void 0,(function*(){const s=y.a.isNotNullOrUndefined(yield this.getFollowedTopic(e,t,i));return s&&(Object(C.a)(R.a.InterestsChange),Object(S.c)(I.a.InterestsChange),Object(P.b)()||Object(L.d)()),s}))}getFollowedTopic(e,t,i){return Object(f.a)(this,void 0,void 0,(function*(){let s=null;if(e&&(s=yield this.getTopic(e)),!Object(X.isNullOrUndefined)(s)&&(s.followState!==o.a.Followed||i)||t){const e=s&&s.feedType!==r.a.UserQuery?s:null,i=s&&s.feedType===r.a.UserQuery?s.name:t,n=yield this.updateTopicFollowingState(e,o.a.Followed,i);n&&(s=yield this.getTopic((null==e?void 0:e.id)||n.targetId),!Object(P.b)()&&(yield Object(a.g)(s,!0,this.followedTopicsListKey)))}return Object(X.isNullOrUndefined)(s)||s.followState!==o.a.Followed?void 0:s}))}getFollowedTopics(e){return Object(f.a)(this,void 0,void 0,(function*(){let t=this.getCurrentState().followedTopicIds;return this.fetchedAllFollowedTopics&&!e||(e=e||(yield this.gettingTopicsAfterMigration()),(yield this.fetchFollowedTopics(e))&&(t=this.getCurrentState().followedTopicIds,e&&!Object(P.b)()&&Object(te.a)())),t}))}getOneServiceFollowedTopics(){return Object(f.a)(this,void 0,void 0,(function*(){try{return yield this.serviceClient.getFollowedTopics(!1,this.useUserCreatedOrder)}catch(e){this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveFollowedTopicsError),{message:"Failed fetching one service followed topics",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveFollowedTopicsError.pb),{customMessage:"Failed fetching one service followed topics. "+(e&&e.message)})}))}}))}getRecommendedTopics(){return Object(f.a)(this,void 0,void 0,(function*(){return this.fetchedAllRecommendedTopics||(yield this.fetchRecommendedTopics()),this.getCurrentState().recommendedTopics}))}getRelatedTopics(e,t){return Object(f.a)(this,void 0,void 0,(function*(){return this.getTopic(e).then(e=>this.serviceClient.getRelatedTopics(e,t))}))}getNextTopicsInList(e=null){return Object(f.a)(this,void 0,void 0,(function*(){let t=this.getCurrentState().topicListMap[e];return!Object(X.isUndefined)(t)&&Object(X.isString)(t.nextPageUrl)&&(yield this.fetchTopicGroup(e))&&(t=this.getCurrentState().topicListMap[e]),t}))}getTopic(e){return Object(f.a)(this,void 0,void 0,(function*(){let t=this.getCurrentState().topicMap[e];return Object(X.isUndefined)(t)&&(yield this.fetchTopic(e))&&(t=this.getCurrentState().topicMap[e]),t}))}getTopics(e){return Object(f.a)(this,void 0,void 0,(function*(){return this.fetchedAllTopics||(yield this.fetchTopics(e)),this.getCurrentState().topicMap}))}unfollowTopic(e,t){return Object(f.a)(this,void 0,void 0,(function*(){const i=yield this.getTopic(e);let s=yield this.updateTopicFollowingState(i,o.a.Unfollowed,null,t);return s&&!t&&(Object(C.a)(R.a.InterestsChange),Object(S.c)(I.a.InterestsChange),Object(P.b)()||Object(L.d)(),Object(ee.a)()&&!Object(P.b)()&&(s=yield Object(a.g)(i,!1,this.followedTopicsListKey))),s}))}restoreDefaultTopics(){return Object(f.a)(this,void 0,void 0,(function*(){try{return yield this.serviceClient.restoreDefaultTopics(),Object(C.a)(R.a.InterestsChange),Object(S.c)(I.a.InterestsChange),Object(P.b)()||Object(L.d)(),yield F.b.purgeCacheAsync(F.a.followedTopics),yield this.getFollowedTopics(!0),!0}catch(e){return this.trackAppError(Object.assign(Object.assign({},v.Ce.FailedRestoringDefaultTopicsError),{message:"Failed restoring default set of followed interests",pb:Object.assign(Object.assign({},v.Ce.FailedRestoringDefaultTopicsError.pb),{customMessage:"Error: "+(e&&e.message)})})),!1}}))}fetchFollowedTopics(e){return Object(f.a)(this,void 0,void 0,(function*(){try{let t;e||!Object(ee.a)()||Object(P.b)()||(yield Object(a.d)(this.followedTopicsListKey),t=yield Object(a.c)(this.followedTopicsListKey));const i=t||(yield this.serviceClient.getFollowedTopics(e,this.useUserCreatedOrder));if(Object(m.a)().IsBlendedEnterprise){const e=Object.values(i).find(e=>"CompanyFeed"===e.branding);e&&(yield this.isLimitedFeed(e))&&delete i[e.id]}return t||(yield Object(a.f)(this.followedTopicsListKey,i,!0)),g.a.followedTopics.getActionSender(this).send(i,e),this.fetchedAllFollowedTopics=!0,!0}catch(e){return g.a.followedTopicsFailed.getActionSender(this).send(),this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveFollowedTopicsError),{message:"Failed fetching followed topics",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveFollowedTopicsError.pb),{customMessage:"Failed fetching followed topics. "+(e&&e.message)})})),!1}}))}isLimitedFeed(e){var t;return Object(f.a)(this,void 0,void 0,(function*(){try{const i={feedId:e.id};e.apiSource&&(i.overwriteBaseApiURL=e.apiSource.baseUrl,i.forceEnterpriseCompliance=(null===(t=e.apiSource)||void 0===t?void 0:t.id)===n.a.work);const s=yield this.cardProvider.fetch(i,!0);return!s||!s.cardMetadata||s.cardMetadata.length<5}catch(e){return this.trackAppError(Object.assign(Object.assign({},v.vh),{message:"[Enterprise] Failed to check if topic has limited data in feed",pb:Object.assign(Object.assign({},v.vh.pb),{customMessage:e&&e.message})})),!1}}))}fetchRecommendedTopics(){return Object(f.a)(this,void 0,void 0,(function*(){try{const e=yield this.serviceClient.getRecommendedTopics();return g.a.recommendedTopics.getActionSender(this).send(Object(ie.a)(e)),this.fetchedAllRecommendedTopics=!0,!0}catch(e){return g.a.recommendedTopicsFailed.getActionSender(this).send(),this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveRecommendedTopicsError),{message:"Failed fetching recommended topics",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveRecommendedTopicsError.pb),{customMessage:"Failed fetching recommended topics. "+(e&&e.message)})})),!1}}))}fetchTopic(e){return Object(f.a)(this,void 0,void 0,(function*(){try{const t=yield this.serviceClient.getTopic(e),i=this.getCurrentState().topicMap[e];return(Object(X.isUndefined)(i)||i.followState!==t.followState)&&g.a.topic.getActionSender(this).send(t),!0}catch(t){return g.a.followedTopicsFailed.getActionSender(this).send(),this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError),{message:"Failed to fetch topic.",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError.pb),{customMessage:`Failed to fetch topic ${e}. ${t&&t.message}`})})),!1}}))}fetchTopicGroup(e){return Object(f.a)(this,void 0,void 0,(function*(){if(!e)return!1;const t=this.getCurrentState().topicListMap[e],i=Object(X.isUndefined)(t)||t.nextPageUrl;if(!Object(X.isString)(i))return!1;const s=d.a.getParamsFromUrl(i);if(null===s)return!1;try{const t=yield this.serviceClient.getTopics(null,s);return g.a.topicGroup.getActionSender(this).send(t.topicGroupMap[e],t.topicMap),!0}catch(t){return g.a.topicGroupFailed.getActionSender(this).send(e),this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError),{message:"Failed to get topics list.",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError.pb),{customMessage:`Failed to get topics list ${e}. ${t&&t.message}`})})),!1}}))}fetchTopics(e){return Object(f.a)(this,void 0,void 0,(function*(){try{const t=yield this.serviceClient.getTopics(e);return g.a.topics.getActionSender(this).send(t),this.fetchedAllTopics=!0,!0}catch(e){return g.a.topicsFailed.getActionSender(this).send(),this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError),{message:"Failed fetching topics.",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError.pb),{customMessage:"Failed fetching topics. "+(e&&e.message)})})),!1}}))}updateTopicFollowingState(e,t,i,s){var r,n;return Object(f.a)(this,void 0,void 0,(function*(){try{const a=t===o.a.Followed,c=yield this.serviceClient.updateTopicFollowingState(e,a,i);return s?!a||(null===(r=null==c?void 0:c.value)||void 0===r?void 0:r.length)&&(null==c?void 0:c.value[0]):(yield F.b.purgeCacheAsync(F.a.followedTopics),!e&&a?yield this.getFollowedTopics(!0):g.a.updateTopicFollowedState.getActionSender(this).send(null==e?void 0:e.id,t,this.useUserCreatedOrder),!a||(null===(n=null==c?void 0:c.value)||void 0===n?void 0:n.length)&&(null==c?void 0:c.value[0]))}catch(i){return g.a.updateTopicFollowedStateFailed.getActionSender(this).send(null==e?void 0:e.id,t),void this.trackAppError(Object.assign(Object.assign({},t?v.Ce.InterestsFollowTopicError:v.Ce.InterestsUnfollowTopicError),{message:"Failed to update topic followed state.",pb:Object.assign(Object.assign({},t?v.Ce.InterestsFollowTopicError.pb:v.Ce.InterestsUnfollowTopicError.pb),{customMessage:`Failed to update followed state to ${t} for ${null==e?void 0:e.id}. ${i&&i.message}`})}))}}))}gettingTopicsAfterMigration(){return Object(f.a)(this,void 0,void 0,(function*(){return!(!Object(O.a)().getItem(h.InterestsNeedRefresh)||(yield Object(Q.d)())!==T.c.SignedIn)&&(Object(O.a)().removeItem(h.InterestsNeedRefresh),!0)}))}trackAppError(e){this.trackAppErrorEventCallback&&this.trackAppErrorEventCallback(Object.assign(Object.assign({},e),{source:"TopicData.connector.ts"}))}}var re=i("Z+pL"),oe=i("05Au");class ne{reduce(e,t){if(!e)return{followedTopicIds:[],followedTopicNames:[],recommendedTopics:[],topicListIds:[],topicListMap:{},topicMap:{},topicsFetchState:s.InProgress};if(!t)return e;let i,r=!1;return r=r||oe.a.handleAction(t,g.a.followedTopics,(t,r)=>{if(!t)return;const o=Object.assign({},e.topicMap);i=Object.assign(Object.assign({},e),{topicMap:o,topicsFetchState:s.Loaded});const n=[];Object.keys(t).forEach(e=>{n.push(e);const i=t[e];o[e]=i}),i.followedTopicIds=r?n:Object(re.a)(i.followedTopicIds,n),i.followedTopicNames=i.followedTopicIds.map(e=>{var t;return null===(t=o[e])||void 0===t?void 0:t.name}),this.updateFollowState(i)}),r=r||oe.a.handleAction(t,g.a.recommendedTopics,t=>{if(!t)return;const r=Object.assign({},e.topicMap);t.forEach(e=>{r[e.id]||(r[e.id]=e)}),i=Object.assign(Object.assign({},e),{recommendedTopics:t,topicMap:r,topicsFetchState:s.Loaded}),this.updateFollowState(i)}),r=r||oe.a.handleAction(t,g.a.topic,t=>{const r=Object.assign({},e.topicMap);r[t.id]=t,i=Object.assign(Object.assign({},e),{topicMap:r,topicsFetchState:s.Loaded})}),r=r||oe.a.handleAction(t,g.a.topics,t=>{if(!t)return;const r=Object.assign({},e.topicMap);Object.keys(t.topicMap).forEach(i=>{const s=e.topicMap[i];r[i]=Object.assign(Object.assign({},t.topicMap[i]),{isInferred:s&&s.isInferred})}),i=Object.assign(Object.assign({},e),{topicListIds:t.topicGroupIds,topicListMap:t.topicGroupMap,topicMap:r,topicsFetchState:s.Loaded}),this.updateFollowState(i)}),r=r||oe.a.handleAction(t,g.a.topicGroup,(t,r)=>{if(!t||!t.topicIds||0===t.topicIds.length||!r)return;const o=Object.assign({},e.topicListMap),n=Object.assign({},e.topicMap),a=o[t.id];t.nextPageUrl&&(a.nextPageUrl=t.nextPageUrl),a&&a.topicIds&&(a.topicIds=Object(re.a)(a.topicIds,t.topicIds)),t.topicIds.forEach(e=>{n[e]=r[e]}),i=Object.assign(Object.assign({},e),{topicListMap:o,topicMap:n,topicsFetchState:s.Loaded}),this.updateFollowState(i)}),r=r||oe.a.handleAction(t,g.a.updateTopicFollowedState,(t,s,r)=>{var n,a;const c=Object.assign({},e.topicMap),d=e.followedTopicIds.slice(),l=e.followedTopicNames.slice(),u=e.topicMap[t];if(s!==o.a.Unfollowed){if(Object(G.a)(u)){const e={followState:o.a.Followed,id:t,name:""};c[t]=e}else{if(u.followState===o.a.Followed&&!u.isInferred)return;u.followState===o.a.Followed&&u.isInferred&&(c[t].isInferred=!1),c[t].followState=o.a.Followed,i=Object.assign(Object.assign({},e),{topicMap:c})}d.indexOf(t)<0&&(r?l.unshift(null===(n=c[t])||void 0===n?void 0:n.name):l.push(null===(a=c[t])||void 0===a?void 0:a.name),r?d.unshift(t):d.push(t))}else{if(Object(G.a)(u))return;c[t].followState=o.a.Unfollowed;const e=d.indexOf(t);e>=0&&(d.splice(e,1),l.splice(e,1))}const p=e.recommendedTopics.map(e=>Object.assign(Object.assign({},e),{followState:e.id===t?s:e.followState}));i=Object.assign(Object.assign({},e),{followedTopicIds:d,followedTopicNames:l,topicMap:c,recommendedTopics:p})}),r=r||oe.a.handleAction(t,g.a.recommendedTopicsFailed,()=>{i=Object.assign(Object.assign({},e),{topicsFetchState:s.Failed})}),r=r||oe.a.handleAction(t,g.a.followedTopicsFailed,()=>{i=Object.assign(Object.assign({},e),{topicsFetchState:s.Failed})}),i||e}updateFollowState(e){const{followedTopicIds:t}=e;Object.keys(e.topicMap).forEach(i=>{const s=e.topicMap[i];s&&(s.followState=t.includes(i)?o.a.Followed:o.a.Unfollowed)}),e.recommendedTopics.forEach(e=>{e.followState=t.includes(e.id)?o.a.Followed:o.a.Unfollowed})}}class ae{constructor(){this.fetchedAllFollowedTopics=!1,this.fetchedAllRecommendedTopics=!1,this.fetchedAllTopics=!1,this.serviceClient=new J(window.fetch.bind(window)),this.followedTopicsListKey=Object(a.b)("followedTopics"),this.useUserCreatedOrder=m.b.CurrentFlights.indexOf("prg-navfr-t")>-1,this.topicDataState={followedTopicIds:[],followedTopicNames:[],topicListIds:[],topicListMap:{},topicMap:{},recommendedTopics:[],topicsFetchState:null}}static getInstance(){return this.instance||(this.instance=new ae),this.instance}static resetInstance(){this.instance=new ae}getCurrentState(){return this.topicDataState}followTopic(e,t,i){return Object(f.a)(this,void 0,void 0,(function*(){const s=y.a.isNotNullOrUndefined(yield this.getFollowedTopic(e,t,i));return s&&(Object(C.a)(R.a.InterestsChange),Object(S.c)(I.a.InterestsChange),Object(L.d)()),s}))}getFollowedTopic(e,t,i){return Object(f.a)(this,void 0,void 0,(function*(){let s=null;if(e&&(s=yield this.getTopic(e)),!Object(X.isNullOrUndefined)(s)&&(s.followState!==o.a.Followed||i)||t){const e=s&&s.feedType!==r.a.UserQuery?s:null,i=s&&s.feedType===r.a.UserQuery?s.name:t,n=yield this.updateTopicFollowingState(e,o.a.Followed,i);n&&(s=yield this.getTopic((null==e?void 0:e.id)||n.targetId),yield Object(a.g)(s,!0,this.followedTopicsListKey))}return Object(X.isNullOrUndefined)(s)||s.followState!==o.a.Followed?void 0:s}))}getFollowedTopics(e){return Object(f.a)(this,void 0,void 0,(function*(){let t=this.topicDataState.followedTopicIds;return this.fetchedAllFollowedTopics&&!e||(e=e||(yield this.gettingTopicsAfterMigration()),(yield this.fetchFollowedTopics(e))&&(t=this.topicDataState.followedTopicIds,e&&Object(te.a)())),t}))}getOneServiceFollowedTopics(){return Object(f.a)(this,void 0,void 0,(function*(){try{return yield this.serviceClient.getFollowedTopics(!1,this.useUserCreatedOrder)}catch(e){this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveFollowedTopicsError),{message:"Failed fetching one service followed topics",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveFollowedTopicsError.pb),{customMessage:"Failed fetching one service followed topics. "+(e&&e.message)})}))}}))}getRecommendedTopics(){return Object(f.a)(this,void 0,void 0,(function*(){return this.fetchedAllRecommendedTopics||(yield this.fetchRecommendedTopics()),this.topicDataState.recommendedTopics}))}getRelatedTopics(e,t){return Object(f.a)(this,void 0,void 0,(function*(){return this.getTopic(e).then(e=>this.serviceClient.getRelatedTopics(e,t))}))}getTopic(e){return Object(f.a)(this,void 0,void 0,(function*(){let t=this.topicDataState.topicMap[e];return Object(X.isUndefined)(t)&&(yield this.fetchTopic(e))&&(t=this.topicDataState.topicMap[e]),t}))}getTopics(e){return Object(f.a)(this,void 0,void 0,(function*(){return this.fetchedAllTopics||(yield this.fetchTopics(e)),this.topicDataState.topicMap}))}unfollowTopic(e,t){return Object(f.a)(this,void 0,void 0,(function*(){const i=yield this.getTopic(e);let s=yield this.updateTopicFollowingState(i,o.a.Unfollowed,null,t);return s&&!t&&(Object(C.a)(R.a.InterestsChange),Object(S.c)(I.a.InterestsChange),Object(L.d)(),s=yield Object(a.g)(i,!1,this.followedTopicsListKey)),s}))}restoreDefaultTopics(){return Object(f.a)(this,void 0,void 0,(function*(){try{return yield this.serviceClient.restoreDefaultTopics(),Object(C.a)(R.a.InterestsChange),Object(S.c)(I.a.InterestsChange),Object(L.d)(),yield F.b.purgeCacheAsync(F.a.followedTopics),yield this.getFollowedTopics(!0),!0}catch(e){return this.trackAppError(Object.assign(Object.assign({},v.Ce.FailedRestoringDefaultTopicsError),{message:"Failed restoring default set of followed interests",pb:Object.assign(Object.assign({},v.Ce.FailedRestoringDefaultTopicsError.pb),{customMessage:"Error: "+(e&&e.message)})})),!1}}))}subscribeTopicDataProviderState(e){e&&(this.stateChangeCallback=e,e(this.topicDataState))}fetchFollowedTopics(e){return Object(f.a)(this,void 0,void 0,(function*(){try{let t;e||(yield Object(a.d)(this.followedTopicsListKey),t=yield Object(a.c)(this.followedTopicsListKey));const i=t||(yield this.serviceClient.getFollowedTopics(e,this.useUserCreatedOrder));return t||(yield Object(a.f)(this.followedTopicsListKey,i,!0)),this.setFollowedTopics(i,e),this.fetchedAllFollowedTopics=!0,!0}catch(e){return this.topicDataState.topicsFetchState=s.Failed,this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveFollowedTopicsError),{message:"Failed fetching followed topics",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveFollowedTopicsError.pb),{customMessage:"Failed fetching followed topics. "+(e&&e.message)})})),!1}}))}fetchRecommendedTopics(){return Object(f.a)(this,void 0,void 0,(function*(){try{const e=yield this.serviceClient.getRecommendedTopics();return this.updateRecommendedTopics(e),this.fetchedAllRecommendedTopics=!0,!0}catch(e){return this.topicDataState.topicsFetchState=s.Failed,this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveRecommendedTopicsError),{message:"Failed fetching recommended topics",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveRecommendedTopicsError.pb),{customMessage:"Failed fetching recommended topics. "+(e&&e.message)})})),!1}}))}fetchTopic(e){return Object(f.a)(this,void 0,void 0,(function*(){try{const t=yield this.serviceClient.getTopic(e),i=this.topicDataState.topicMap[e];return(Object(X.isUndefined)(i)||i.followState!==t.followState)&&(this.topicDataState.topicMap[t.id]=t),!0}catch(t){return this.topicDataState.topicsFetchState=s.Failed,this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError),{message:"Failed to fetch topic.",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError.pb),{customMessage:`Failed to fetch topic ${e}. ${t&&t.message}`})})),!1}}))}fetchTopicGroup(e){return Object(f.a)(this,void 0,void 0,(function*(){if(!e)return!1;const t=this.topicDataState.topicListMap[e],i=Object(X.isUndefined)(t)||t.nextPageUrl;if(!Object(X.isString)(i))return!1;const s=d.a.getParamsFromUrl(i);if(null===s)return!1;try{const t=yield this.serviceClient.getTopics(null,s);return this.updateTopicGroup(t.topicGroupMap[e],t.topicMap),!0}catch(t){return this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError),{message:"Failed to get topics list.",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError.pb),{customMessage:`Failed to get topics list ${e}. ${t&&t.message}`})})),!1}}))}fetchTopics(e){return Object(f.a)(this,void 0,void 0,(function*(){try{const t=yield this.serviceClient.getTopics(e);return this.updateTopics(t),this.fetchedAllTopics=!0,!0}catch(e){return this.trackAppError(Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError),{message:"Failed fetching topics.",pb:Object.assign(Object.assign({},v.Ce.InterestsRetrieveTopicsError.pb),{customMessage:"Failed fetching topics. "+(e&&e.message)})})),!1}}))}updateFollowState(){const{followedTopicIds:e,topicMap:t,recommendedTopics:i}=this.topicDataState;Object.keys(t).forEach(i=>{const s=t[i];s&&(s.followState=e.includes(i)?o.a.Followed:o.a.Unfollowed)}),i.forEach(t=>{t.followState=e.includes(t.id)?o.a.Followed:o.a.Unfollowed}),this.reportTopicDataStateChange()}updateTopicFollowingState(e,t,i,s){var r,n;return Object(f.a)(this,void 0,void 0,(function*(){try{const a=t===o.a.Followed,c=yield this.serviceClient.updateTopicFollowingState(e,a,i);return s?!a||(null===(r=null==c?void 0:c.value)||void 0===r?void 0:r.length)&&(null==c?void 0:c.value[0]):(yield F.b.purgeCacheAsync(F.a.followedTopics),!e&&a?yield this.getFollowedTopics(!0):this.updateTopicFollowedState(null==e?void 0:e.id,t,this.useUserCreatedOrder),!a||(null===(n=null==c?void 0:c.value)||void 0===n?void 0:n.length)&&(null==c?void 0:c.value[0]))}catch(i){return void this.trackAppError(Object.assign(Object.assign({},t?v.Ce.InterestsFollowTopicError:v.Ce.InterestsUnfollowTopicError),{message:"Failed to update topic followed state.",pb:Object.assign(Object.assign({},t?v.Ce.InterestsFollowTopicError.pb:v.Ce.InterestsUnfollowTopicError.pb),{customMessage:`Failed to update followed state to ${t} for ${null==e?void 0:e.id}. ${i&&i.message}`})}))}}))}updateRecommendedTopics(e){if(!e)return;e=Object(ie.a)(e);const t=Object.assign({},this.topicDataState.topicMap);e.forEach(e=>{t[e.id]||(t[e.id]=e)}),this.topicDataState=Object.assign(Object.assign({},this.topicDataState),{recommendedTopics:e,topicMap:t,topicsFetchState:s.Loaded}),this.updateFollowState()}updateTopicGroup(e,t){if(!e||!e.topicIds||0===e.topicIds.length||!t)return;const i=Object.assign({},this.topicDataState.topicListMap),r=Object.assign({},this.topicDataState.topicMap),o=i[e.id];e.nextPageUrl&&(o.nextPageUrl=e.nextPageUrl),o&&o.topicIds&&(o.topicIds=Object(re.a)(o.topicIds,e.topicIds)),e.topicIds.forEach(e=>{r[e]=t[e]}),this.topicDataState=Object.assign(Object.assign({},this.topicDataState),{topicListMap:i,topicMap:r,topicsFetchState:s.Loaded}),this.updateFollowState()}updateTopics(e){if(!e)return;const t=Object.assign({},this.topicDataState.topicMap);Object.keys(e.topicMap).forEach(i=>{const s=this.topicDataState.topicMap[i];t[i]=Object.assign(Object.assign({},e.topicMap[i]),{isInferred:s&&s.isInferred})}),this.topicDataState=Object.assign(Object.assign({},this.topicDataState),{topicListIds:e.topicGroupIds,topicListMap:e.topicGroupMap,topicMap:t,topicsFetchState:s.Loaded}),this.updateFollowState()}setFollowedTopics(e,t){if(!e)return;const i=Object.assign({},this.topicDataState.topicMap);this.topicDataState=Object.assign(Object.assign({},this.topicDataState),{topicMap:i,topicsFetchState:s.Loaded});const r=[];Object.keys(e).forEach(t=>{r.push(t);const s=e[t];i[t]=s}),this.topicDataState.followedTopicIds=t?r:Object(re.a)(this.topicDataState.followedTopicIds,r),this.topicDataState.followedTopicNames=this.topicDataState.followedTopicIds.map(e=>{var t;return null===(t=i[e])||void 0===t?void 0:t.name}),this.updateFollowState()}updateTopicFollowedState(e,t,i){var s,r;const n=Object.assign({},this.topicDataState.topicMap),a=this.topicDataState.followedTopicIds.slice(),c=this.topicDataState.followedTopicNames.slice(),d=this.topicDataState.topicMap[e];if(t!==o.a.Unfollowed){if(Object(X.isUndefined)(d)){const t={followState:o.a.Followed,id:e,name:""};n[e]=t}else{if(d.followState===o.a.Followed&&!d.isInferred)return;d.followState===o.a.Followed&&d.isInferred&&(n[e].isInferred=!1),n[e].followState=o.a.Followed;Object.assign(Object.assign({},this.topicDataState),{topicMap:n})}i?c.unshift(null===(s=n[e])||void 0===s?void 0:s.name):c.push(null===(r=n[e])||void 0===r?void 0:r.name),i?a.unshift(e):a.push(e)}else{if(Object(X.isUndefined)(d))return;n[e].followState=o.a.Unfollowed;const t=a.indexOf(e);a.splice(t,1),c.splice(t,1)}const l=this.topicDataState.recommendedTopics.map(i=>Object.assign(Object.assign({},i),{followState:i.id===e?t:i.followState}));this.topicDataState=Object.assign(Object.assign({},this.topicDataState),{followedTopicIds:a,followedTopicNames:c,topicMap:n,recommendedTopics:l}),this.reportTopicDataStateChange()}reportTopicDataStateChange(){this.stateChangeCallback&&this.topicDataState&&this.stateChangeCallback(this.topicDataState)}gettingTopicsAfterMigration(){return Object(f.a)(this,void 0,void 0,(function*(){return!(!Object(O.a)().getItem(h.InterestsNeedRefresh)||(yield Object(Q.d)())!==T.c.SignedIn)&&(Object(O.a)().removeItem(h.InterestsNeedRefresh),!0)}))}trackAppError(e){Z.a.sendAppErrorEvent(Object.assign(Object.assign({},e),{source:"WindowsTopicDataProvider.ts"}))}}const ce={experienceConfigSchema:{}}},"2pXY":function(e,t,i){"use strict";t.a=function(e,t,i){for(var s=-1,r=null==e?0:e.length;++s<r;)if(i(t,e[s]))return!0;return!1}},"4t6e":function(e,t,i){"use strict";var s=i("gFym"),r=i("GAvS"),o=i("PYp2"),n=i("SEb4"),a=r.a?r.a.isConcatSpreadable:void 0;var c=function(e){return Object(n.a)(e)||Object(o.a)(e)||!!(a&&e&&e[a])};t.a=function e(t,i,r,o,n){var a=-1,d=t.length;for(r||(r=c),n||(n=[]);++a<d;){var l=t[a];i>0&&r(l)?i>1?e(l,i-1,r,o,n):Object(s.a)(n,l):o||(n[n.length]=l)}return n}},"623N":function(e,t,i){"use strict";var s;i.d(t,"a",(function(){return s})),function(e){e.consumer="consumer",e.work="work"}(s||(s={}))},"6ADy":function(e,t,i){"use strict";i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return u})),i.d(t,"a",(function(){return p}));var s=i("rvYQ"),r=i("I6Lx"),o=i("kN1G"),n=i("tMmC");let a,c;function d(){const e=Object(s.b)();if(!a){!function(e){a=new URL("",e),h(a)}(Object(o.j)()&&Object(o.k)()?e.EnterpriseServiceUrlBase:e.ServiceUrlBase)}return a}function l(){const e=Object(s.b)();if(!c){!function(e){c=new URL("",e),h(c)}(Object(o.j)()&&Object(o.k)()?e.EnterpriseServiceUrlBase:e.FeedServiceUrlBase)}return c}function u(e,t=d()){return new URL(e+(null==t?void 0:t.search),t)}function p(e,t=l()){return new URL(e+(null==t?void 0:t.search),t)}function h(e){let t=!1;"dev"!==e.searchParams.get("env.service")&&Object(r.a)().UserIsSignedIn&&(t=!0),n.a.log("u-si: "+Object(s.b)().UserId),n.a.log("a-si: "+t),n.a.log("ss-si: "+Object(r.a)().UserIsSignedIn)}},CzGr:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("D57K"),r=(i("fuIx"),i("Zsg4"),i("e8jz"));function o(){return Object(s.a)(this,void 0,void 0,(function*(){const e={},t=Object(r.b)();if(t){e.MUID=t.muid;const i=yield Object(r.a)("service::api.msn.com::MBI_SSL");"MSA"===t.accountType&&i?e.UserAuthToken=i:"AAD"===t.accountType&&i&&(e.Authorization=i)}return e}))}},JFdr:function(e,t,i){"use strict";var s=Math.floor,r=Math.random;t.a=function(e,t){return e+s(r()*(t-e+1))}},KETb:function(e,t,i){"use strict";i.d(t,"a",(function(){return A})),i.d(t,"b",(function(){return M}));var s=i("D57K"),r=i("XlyT"),o=i("IhCV"),n=i("z2Ro"),a=i("vq4Z"),c=i("VcDS");class d extends n.a{constructor(e,t,i,s){super(e,i,c.a.BeginActivity,o.a.newGuid(),new Date,t),this.LogLevel=a.a.Activity,this.Ended=!1,this.correlationVector=s}}var l=i("KSHU"),u=i("mRXR");class p extends n.a{constructor(e,t,i,s,r,n,d,l){super(e,l,c.a.BeginNetworkActivity,o.a.newGuid(),new Date,d),this.serviceName=t,this.LogLevel=a.a.Activity,this.Ended=!1,this.requestUri=i,this.requestHttpMethod=s,this.currentOperationName=r,this.correlationVector=n}}var h=i("9RHM");class g extends l.a{constructor(e,t){super(e),this.correlationVectorProvider=t}static getInstance(e,t){var i=e||"Default",s=g.InstancesMap[i];if(s)return s;var r=new u.a(i,a.a.Activity);return s=new g(r,t),g.InstancesMap[i]=s,s}isActivityEnabled(){return this.logger.isEnabledFor(a.a.Activity)}createActivity(e,t,i){if(this.isActivityEnabled()){let s,r;t&&(s=t.ActivityId,r=this.getVectorForNewActivity(t,!1));let o=new d(e,s,i,r);return this.logger.log(a.a.Activity,o),o}return t||null}createActivityCallback(e,t,i){return this.isActivityEnabled()?this.createActivity(e(),t,i):t||null}endActivity(e){if(this.isActivityEnabled()&&e&&!e.Ended){e.Ended=!0;const t=new Date,i=Object(h.a)(e);i.LogType=c.a.EndActivity,i.LogDateTime=t;const s=i.LogDateTime.getTime()-e.LogDateTime.getTime();i.Message=i.Message+" ElapsedTime (Milliseconds):"+s.toString(),i.elapsedTimeInMs=s,this.logger.log(a.a.Activity,i)}}createNetworkActivity(e,t,i,s,r,o,n,a){if(this.isActivityEnabled()){o||n||console.warn("'correlationVector' or 'parentActivity' is required to create network activity");let c=o||this.getVectorForNewActivity(n,!0),d=n?n.ActivityId:"";return new p(e,t,i,s,r,c,d,a)}return null}endSuccessfulNetworkActivity(e,t,i){this.endNetworkActivity(e,!0,t,i)}endFailedNetworkActivity(e,t,i,s){this.endNetworkActivity(e,!1,t,i,s)}endNetworkActivity(e,t,i,s,r){if(e&&!e.Ended){e.Ended=!0;let o=new Date,n=Object(h.a)(e);n.LogType=c.a.EndNetworkActivity,n.LogDateTime=o,n.elapsedTimeInMs=n.LogDateTime.getTime()-e.LogDateTime.getTime(),n.successful=t,n.responseSize=i,n.responseStatusCode=s,n.errorMessage=r,this.logger.log(a.a.Activity,n)}}getVectorForNewActivity(e,t){return e&&this.correlationVectorProvider?(e.latestChildCorrelationVector?e.latestChildCorrelationVector=this.correlationVectorProvider.incrementExternalVector(e.latestChildCorrelationVector):(e.latestChildCorrelationVector=this.correlationVectorProvider.extendExternalVector(e.correlationVector),t&&(e.latestChildCorrelationVector=this.correlationVectorProvider.incrementExternalVector(e.latestChildCorrelationVector))),e.latestChildCorrelationVector):""}}g.InstancesMap={};var f=i("/wq8");class v{constructor(e){if(this.loggingService=e,!e)throw"loggingService is required for LoggedExceptionManager."}error(e){throw this.loggingService.error(e),e}fatal(e){throw this.loggingService.fatal(e),e}}var b=i("HDSB");class m{constructor(e,t,i,s,r,o,n){if(!e)throw new Error("loggingService is required for ExponentialBackoffRetry.");const a=new v(e);this.logInvalidParams(a,t,i,s,r,n),this.loggingService=e,this.maxRetries=t||m.defaultMaxRetries,this.baseRetryDelayInMs=i||m.defaultBaseRetryDelayInMs,this.maxRetryDelayInMs=s||m.maxAllowedRetryDelayInMs,this.factor=r||m.defaultFactor,this.minOffsetInMs=o||m.defaultMinOffsetInMs,this.maxOffsetInMs=n||m.defaultMaxOffsetInMs,Object(b.a)()&&this.loggingService.infoCallback(()=>"ExponentialBackoffRetry has been configured.",null,{maxRetries:t,minTimeout:i,maxTimeout:s,factor:r})}executeRequest(e,t,i){return Object(s.a)(this,void 0,void 0,(function*(){return new Promise((r,o)=>Object(s.a)(this,void 0,void 0,(function*(){yield this.tryRequest(e,r,o,0,t,i)})))}))}logInvalidParams(e,t,i,s,r,o){t&&(t<1||t>m.maxAllowedRetries)&&e.fatal(`maxRetries should be at least 1 and less than ${m.maxAllowedRetries}.`),i&&i<m.defaultBaseRetryDelayInMs&&e.fatal("baseRetryDelay has to be a positive value greater than or equal to 100."),i&&o&&i<=o&&e.fatal("baseRetryDelay must not be smaller than the maximum delay offset."),s&&(s<=0||s>m.maxAllowedRetryDelayInMs)&&e.fatal(`maxRetryDelay has to be a positive value less than ${m.maxAllowedRetryDelayInMs}.`),r&&r<=0&&e.fatal("factor has to be a positive value.")}tryRequest(e,t,i,r,o,n){return Object(s.a)(this,void 0,void 0,(function*(){try{const i=1e4,s=yield this.timeoutServiceRequest(i,e());t(s)}catch(s){if(Object(b.a)()&&r<this.maxRetries){const a=3,c=parseFloat((Math.random()*(this.minOffsetInMs-this.maxOffsetInMs)+this.maxOffsetInMs).toFixed(a)),d=.5,l=Math.random()<d?-1:1,u=Math.min(this.baseRetryDelayInMs*Math.pow(this.factor,r),this.maxRetryDelayInMs)+c*l;this.loggingService.warnCallback(()=>`Retrying the request in ${u} milliseconds.`,n,{error:s,currentRetry:r+1,requestInfo:o}),setTimeout(()=>this.tryRequest(e,t,i,r+1,o,n),u)}else this.loggingService.errorCallback(()=>Object(b.a)()&&r<this.maxRetries?"ExponentialBackoffRetry has exceeded maximum retries "+this.maxRetries:"Request has failed.",n,{error:s,currentRetry:r,requestInfo:o}),i(s)}}))}timeoutServiceRequest(e,t){return Object(s.a)(this,void 0,void 0,(function*(){return new Promise((i,r)=>Object(s.a)(this,void 0,void 0,(function*(){const s=setTimeout(()=>r(new Error("Service Request Timed out!")),e);try{const e=yield t;i(e),clearTimeout(s)}catch(e){r(e),clearTimeout(s)}})))}))}}m.defaultBaseRetryDelayInMs=100,m.defaultFactor=2,m.defaultMaxOffsetInMs=25,m.defaultMaxRetries=5,m.defaultMinOffsetInMs=1,m.maxAllowedRetries=10,m.maxAllowedRetryDelayInMs=2e3;var y,O=i("VOUN"),j=i("hqLi");class T extends n.a{constructor(e,t,i,s,r){super(e,i,c.a.Instrumentation,s,r),this._counterName=e,this.CounterValue=t}get CounterName(){return this._counterName}incrementValue(){if("number"!=typeof this.CounterValue)throw"ERROR: Counter value is never initialized, cannot perform increment action.";this.CounterValue++}}class w extends l.a{constructor(e){super(e)}static getInstance(e){const t=e||"Default";let i=w.InstancesMap[t];if(i)return i;let s=new u.a(t,a.a.Trace);return i=new w(s),w.InstancesMap[t]=i,i}static getDimensionedLogItems(e,t){let i=[],s=new T(e.CounterName,e.CounterValue,Object(h.a)(e.Data),e.ActivityId,e.LogDateTime);if(s.LogLevel=a.a.Trace,i.push(s),t&&!Object(j.a)(t))for(let s of Object.keys(t))for(let r of t[s]){let t=s.indexOf(":")>-1?`${e.CounterName}(${s.replace(":","-")}: ${r})`:`${e.CounterName}(${s}: ${r})`,o=new T(t,e.CounterValue,Object(h.a)(e.Data),e.ActivityId,e.LogDateTime);o.LogLevel=a.a.Trace,i.push(o)}return i}logPerfCounter(e,t,i,s){const r=new T(e,t,s);this.logPerfCounterItem(r,i)}logPerfCounterItem(e,t){const i=w.getDimensionedLogItems(e,t);for(let e of i)this.logger.log(a.a.Trace,e)}}w.InstancesMap={};class S extends n.a{constructor(e,t,i,s,r,o,n,c){super(e,n),this.pageName=e,this.LogLevel=a.a.Activity,this._userActivityType=t,this.correlationVector=i,this.trackingData=s,this.pageTitle=r,this.pageUri=o,this.eventData=c}get userActivityType(){return this._userActivityType}}!function(e){e[e.None=0]="None",e[e.PageAction=1]="PageAction",e[e.PageView=2]="PageView"}(y||(y={}));class I extends l.a{constructor(e){super(e)}static getInstance(e){var t=e||"Default",i=I.InstancesMap[t];if(i)return i;var s=new u.a(t,a.a.Activity);return i=new I(s),I.InstancesMap[t]=i,i}isActivityTrackingEnabled(){return this.logger.isEnabledFor(a.a.Activity)}logPageView(e,t,i,s,r,o){this.isActivityTrackingEnabled()&&this.logger.log(a.a.Activity,this.getUserActivityLogItem(e,t,i,r,o,s))}logPageActionEvent(e,t,i,s,r,o,n){if(this.isActivityTrackingEnabled()){if(!e)throw"''eventData' required for logging page action event.";e.elementTitle&&e.eventType&&e.elementTitle.trim()&&e.eventType.trim()&&this.logger.log(a.a.Activity,this.getUserActivityLogItem(t,i,s,o,n,r,e))}}getUserActivityLogItem(e,t,i,s,r,o,n){if(!e)throw"''pageName' is required for logging user activity.";return n?new S(e,y.PageAction,t,i,s,r,o,n):new S(e,y.PageView,t,i,s,r,o)}}I.InstancesMap={};class C{constructor(e,t,i,s){this.loggingServiceInstance=e||O.a.getInstance(),this.activityServiceInstance=t||g.getInstance(),this.userActivityServiceInstance=i||I.getInstance(),this.perfCounterServiceInstance=s||w.getInstance()}get loggingService(){return this.loggingServiceInstance}get activityLoggingService(){return this.activityServiceInstance}get userActivityTrackingService(){return this.userActivityServiceInstance}get perfCounterLoggingService(){return this.perfCounterServiceInstance}getLoggingServiceByName(e){return this.checkLoggerName(e),O.a.getInstance(e)}getActivityLoggingServiceByName(e){return this.checkLoggerName(e),g.getInstance(e)}getUserActivityTrackingServiceByName(e){return this.checkLoggerName(e),I.getInstance(e)}getPerfCounterLoggingServiceByName(e){return this.checkLoggerName(e),w.getInstance(e)}addActivityLoggingService(e){this.checkServiceInstance(e),g.getInstance(e.getLoggerName())}checkLoggerName(e){if(!e)throw"'loggerName' is required."}checkServiceInstance(e){if(!e)throw"'serviceInstance' is required."}}var R=i("msIb"),F=i("tMmC");let k,E;function A(e,t,i){return Object(s.a)(this,void 0,void 0,(function*(){let s,o;try{if(s=yield fetch(e,t),s&&s.ok)return s}catch(t){Object(r.c)(t,i,"Exception calling 1S primary Url: "+e)}return s&&s.headers&&s.headers.get("OneWebServiceLatency")?s:e.indexOf("assets.msn.com/service/")>0?(o=e.replace("assets.msn.com/service/","api.msn.com/"),yield fetch(o,t)):s}))}function M(e,t){return Object(s.a)(this,void 0,void 0,(function*(){const i=U().activityLoggingService.createActivity(t);return yield R.a.serviceRequestOnComplete(()=>function(){if(E)return E;return E=new m(U().loggingService,3),E}().executeRequest(e,null,i),()=>U().activityLoggingService.endActivity(i))}))}function U(){if(k)return k;const e=g.getInstance("ExperienceActivityLogger");return Object(b.a)()&&F.a.isDebug()&&e.addAppender(new f.a(a.a.Activity)),k=new C(F.a.getLoggingService(),e),k}},LHdR:function(e,t,i){"use strict";var s=i("XhxR"),r=i("zI0X"),o=i("2pXY"),n=i("aPP9"),a=i("FROA"),c=i("d9YH"),d=i("U64u"),l=a.a&&1/Object(d.a)(new a.a([,-0]))[1]==1/0?function(e){return new a.a(e)}:c.a;t.a=function(e,t,i){var a=-1,c=r.a,u=e.length,p=!0,h=[],g=h;if(i)p=!1,c=o.a;else if(u>=200){var f=t?null:l(e);if(f)return Object(d.a)(f);p=!1,c=n.a,g=new s.a}else g=t?[]:h;e:for(;++a<u;){var v=e[a],b=t?t(v):v;if(v=i||0!==v?v:0,p&&b==b){for(var m=g.length;m--;)if(g[m]===b)continue e;t&&g.push(b),h.push(v)}else c(g,b,i)||(g!==h&&g.push(b),h.push(v))}return h}},LJMo:function(e,t,i){"use strict";var s;function r(e){switch(e){case"ArticlePreview":return 13;case"SlideshowPreview":return 14;case"VideoPreview":return 15;default:return null}}i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r})),function(e){e.Article="article",e.Slideshow="slideshow",e.Video="video",e.Spotlight="content360",e.Infopane="infopane",e.TabbedInfopane="tabbedInfopane",e.HalfPane="HalfPane",e.HeadToHead="HeadToHead",e.Mosaic="Mosaic",e.Triptych="Triptych",e.TabbedInfopaneTab="tabbedInfopaneTab",e.WebContent="webcontent",e.ExternalLink="link",e.DenseList="DenseList",e.BackFillContent="BackfillContent",e.MyBriefRiverCard="toppicks",e.NativeAd="nativead",e.CmsAd="cmsad",e.ShoppingCard="ShoppingCard",e.ShoppingCarousel="ShoppingCarousel",e.ComicsCarousel="ComicsCarousel",e.EditorsPickCarousel="EditorsPickCarousel",e.SelectCarousel="SelectCarousel",e.DailyFixGamesCarousel="DailyFixGamesCarousel",e.NewsSegmentCarousel="NewsSegmentCarousel",e.SubscriptionCarousel="SubscriptionCarousel",e.TopStories="topStories",e.WorkHeadlines="workNews",e.Trending="trendingnow",e.LocalNews="XfeedUpsell",e.LocalNewsFeed="LocalNewsFeed",e.TrendingInTenMinutes="trendingInTenMinutes",e.Horoscope="Horoscope",e.Elections="GenericElection",e.RecommendedSearchCarousel="RecommendedSearch",e.OnThisDay="OnThisDay",e.Lottery="Lottery",e.PartnerUpsell="PartnerUpsell",e.Qna="qnacard",e.Recipes="recipecard",e.TravelDestinationCard="TravelDestinationCard",e.TravelDestinationCarouselCard="TravelDestinationCarouselCard",e.BingHealthCovid19StatsCard="Covid19Stats",e.PlaceholderCard="placeholder",e.BingVideo="BingVideo",e.BingVideoCarousel="BingVideoCarousel",e.EsportsHighlight="esportsHighlight",e.EsportsLiveStream="esportsLiveStream",e.EsportsMatch="esportsMatch",e.EsportsTournament="esportsTournament",e.WeatherSummary="WeatherSummary",e.WeatherSummary_spotlight="WeatherSummary_spotlight",e.StockQuote="StockQuote",e.StockQuote_spotlight="StockQuote_spotlight",e.MoneyInfo="MoneyInfo",e.SportsMatch="SportsMatch",e.SportsOlympics="SportsOlympics",e.TrafficDelays="TrafficDelays",e.ShoppingMerchantCategoryDeals="ShoppingMerchantCategoryDeals",e.Group="group",e.Upsell="FreUpsell",e.Dense="densetab",e.IndustryNewsCard="IndustryNewsCard",e.RecommendedCardFeed="RecommendedCardFeed",e.TopicFeed="TopicFeed"}(s||(s={}))},MMvm:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var s=i("D57K"),r=i("ax+D"),o=i("rvYQ"),n=i("y+Kz"),a=i("6ADy"),c=i("msIb"),d=i("KETb"),l=i("fuIx"),u=i("CzGr"),p=i("e8jz"),h=i("Zsg4"),g=i("HxRh"),f=i("tERu"),v=i("/+Un"),b=i("NkTa");class m{constructor(e,t){this.fetchImpl=e,this.handleAppErrorEventCall=t,this.endPoint="msn/suggestions",this.servicdeOcid="feeds"}getSuggestedInterests(e,t,i){return Object(s.a)(this,void 0,void 0,(function*(){if(r.a.isNullOrWhiteSpace(e))return[];const s=e.trim(),o=yield this.getRequestInit(),n=[...yield this.getCommonParams(this.servicdeOcid),{key:"qscope",value:"news"},{key:"q",value:s},{key:"Type",value:i||"provider,bingtopic,category"},{key:"$top",value:String(t)}],c=Object(a.c)(this.endPoint);n.forEach(e=>e.value&&c.searchParams.set(e.key,e.value));const d=yield this.sendRequest(decodeURIComponent(c.href),o);if(!d)return null;let l=null;try{l=d.value[0].groups[0].suggestionItems}catch(e){this.handleAppErrorEventCall(g.Ee.ErrorResponseFromOneServiceIsInvalid)}return Object(b.a)(l,"id")}))}getRequestInit(e=null){return Object(s.a)(this,void 0,void 0,(function*(){return null==e&&(e={method:"GET"}),(yield Object(v.d)())===f.c.SignedIn&&(e.credentials="include"),e.headers=Object(l.b)()?yield Object(u.a)():yield c.a.getOneServiceHeaders(),e}))}getCommonParams(e){return Object(s.a)(this,void 0,void 0,(function*(){if(Object(l.b)())return this.getSapphireQueryParams();return(yield Object(v.d)())===f.c.SignedIn?c.a.getOneServiceParamsWithAuth(o.a.UserId,e):c.a.getOneServiceParamsWithoutAuth(o.a.UserId,e)}))}getSapphireQueryParams(){const e=c.a.getOneServiceNonDynamicParamsWithoutAuth(this.servicdeOcid),t=Object(p.b)();return t&&(e.push({key:n.t.market,value:t.market}),e.push({key:n.t.fdhead,value:t.features}),e.push({key:n.t.activityId,value:t.activityId}),t.latitude&&t.longitude&&e.push({key:n.t.location,value:`${t.latitude}|${t.longitude}`})),e}sendRequest(e,t){return Object(s.a)(this,void 0,void 0,(function*(){return Object(l.b)()?yield this.sapphireRequest(decodeURIComponent(e),t):yield this.networkRequest(decodeURIComponent(e),t)}))}sapphireRequest(e,t){return Object(s.a)(this,void 0,void 0,(function*(){const i={url:e,headers:t.headers,body:t.body,refresh:!0},s=yield Object(h.c)(i);return JSON.parse(s||"{}")}))}networkRequest(e,t){return Object(s.a)(this,void 0,void 0,(function*(){return yield Object(d.b)(()=>Object(s.a)(this,void 0,void 0,(function*(){const i=yield this.fetchImpl(e,t);return i.ok?i.json():(this.handleAppErrorEventCall(g.Ee.ErrorResponseFromOneService),null)})),"getSuggestedInterests")}))}}},NkTa:function(e,t,i){"use strict";var s=i("wh7w"),r=i("LHdR");t.a=function(e,t){return e&&e.length?Object(r.a)(e,Object(s.a)(t,2)):[]}},NuVg:function(e,t,i){"use strict";t.a=function(e){return void 0===e}},OTKB:function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"g",(function(){return c})),i.d(t,"f",(function(){return d})),i.d(t,"e",(function(){return l})),i.d(t,"d",(function(){return u})),i.d(t,"a",(function(){return p}));var s=i("hOj1"),r=i("rvYQ"),o=i("I6Lx");const n="00000000400F9D16",a="3a4d129e-7f50-4e0d-a7fd-033add0a29f4",c="service::www.msn.com::MBI_SSL",d="User.Read Userinfo.ReadWrite",l="https://www.api.msn.com/",u="https://enterprisenews.microsoft.com/";function p(e){var t;const i=r.a.IsCnDomain||"zh-cn"===(null===(t=null===o.b||void 0===o.b?void 0:o.b.Locale)||void 0===t?void 0:t.toLowerCase());e&&Object(s.c)("MUID",e,365,i?".msn.cn":".msn.com","/")}},OTRt:function(e,t,i){"use strict";var s,r;i.d(t,"a",(function(){return s})),function(e){e.CardView="cardview",e.FlatView="flatview"}(s||(s={})),function(e){e.t3="T3",e.t6="T6"}(r||(r={}))},VGrc:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return c}));var s=i("D57K"),r=i("XlyT"),o=i("HxRh"),n=i("rfxS");function a(e,t,i,a,c=""){return Object(s.a)(this,void 0,void 0,(function*(){if(!e)return null;try{const s=e.tryGetApi("authenticator",n.a,n.a);return yield s.getToken(t,i,a,c)}catch(e){return Object(r.c)(e,o.Xb,"Exception calling GetToken",JSON.stringify(e)),null}}))}function c(e){return Object(s.a)(this,void 0,void 0,(function*(){if(!e)return null;try{const t=e.tryGetApi("authenticator",n.a,n.a);return yield t.getProperty("MUID")}catch(e){return Object(r.c)(e,o.Xb,"Exception fetching MUID",JSON.stringify(e)),null}}))}},YI90:function(e,t,i){"use strict";var s=i("JFdr"),r=i("p6Gq"),o=i("syaE"),n=parseFloat,a=Math.min,c=Math.random;t.a=function(e,t,i){if(i&&"boolean"!=typeof i&&Object(r.a)(e,t,i)&&(t=i=void 0),void 0===i&&("boolean"==typeof t?(i=t,t=void 0):"boolean"==typeof e&&(i=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=Object(o.a)(e),void 0===t?(t=e,e=0):t=Object(o.a)(t)),e>t){var d=e;e=t,t=d}if(i||e%1||t%1){var l=c();return a(e+l*(t-e+n("1e-"+((l+"").length-1))),t)}return Object(s.a)(e,t)}},"Z+pL":function(e,t,i){"use strict";var s=i("4t6e"),r=i("2JSu"),o=i("LHdR"),n=i("NZVk"),a=Object(r.a)((function(e){return Object(o.a)(Object(s.a)(e,1,n.a,!0))}));t.a=a},ac9z:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"d",(function(){return p})),i.d(t,"e",(function(){return h})),i.d(t,"b",(function(){return g})),i.d(t,"c",(function(){return f}));var s=i("D57K"),r=i("k3mM"),o=i("hOj1"),n=i("rvYQ"),a=i("zfSW"),c=i("l+Jz"),d=i("tWvP");const l="cbypass";let u=parseInt(Object(o.a)(l))||0;function p(){return Object(s.a)(this,void 0,void 0,(function*(){u=Date.now(),Object(d.a)(l,u.toString(),10/1440,n.a.HostPage.topDomain,"/"),yield r.b.purgeCacheAsync(r.a.river),Object(a.d)({id:c.a.UpdateMyFeed,payload:u})}))}function h(){return Object(s.a)(this,void 0,void 0,(function*(){u=Date.now(),Object(d.a)(l,u.toString(),10/1440,n.a.HostPage.topDomain,"/"),yield r.b.purgeCacheAsync(r.a.river)}))}function g(){return u}function f(e){u>0&&e.searchParams.set(l,u.toString())}},eupA:function(e,t,i){"use strict";var s=i("JFdr");t.a=function(e,t){var i=-1,r=e.length,o=r-1;for(t=void 0===t?r:t;++i<t;){var n=Object(s.a)(i,o),a=e[n];e[n]=e[i],e[i]=a}return e.length=t,e}},hDMs:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var s,r=i("ADRF"),o=i("rvYQ");!function(e){e.contentUrlPrefixLookup={article:"ar",video:"vi",slideshow:"ss"},e.generateTopicLink=function(e,t){const i=r.a.encodeURIComponentForPrime(t).toLowerCase(),{HostPage:s}=o.a;if(s){const t=new URL(s.originalUrl);return t.origin+"/"+s.verticalKey+"/"+s.categoryKey+"/interests/"+i+"/"+o.a.CurrentMarket+"/f-"+e+t.search}return"https://www.msn.com"},e.generateContentLink=function(t,i,s,r,n){return t&&i&&s&&r&&n?`/${o.a.CurrentMarket}/${t}/${i}/${r}/${e.contentUrlPrefixLookup[n]}-${s}`:"/"}}(s||(s={}))},mOQN:function(e,t,i){"use strict";var s=i("oKML"),r=i("FoV5");t.a=function(e){return null==e?[]:Object(s.a)(e,Object(r.a)(e))}},msIb:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var s,r=i("D57K"),o=i("rvYQ"),n=i("y+Kz"),a=i("I6Lx"),c=i("wBSZ"),d=i("OTKB"),l=i("hOj1"),u=i("ax+D"),p=i("BQg2"),h=i("kN1G"),g=i("VGrc"),f=i("/+Un"),v=i("HDSB"),b=i("NIfb"),m=i("4wjP"),y=i("MptA"),O=i("u5KZ"),j=i("HxRh");!function(e){let t;function i(e=null,t,i=!0,s=null,r=!1,c=Object(h.j)()){const d=Object(o.b)(),l=[{key:n.t.apiKey,value:d.OneServiceApiKey},{key:n.t.activityId,value:d.ActivityId},{key:n.t.ocid,value:i?T(d.TrackInfo,t):t},{key:n.t.market,value:d.CurrentMarket}];e&&l.push({key:n.t.user,value:e});let u=Object(a.a)().CurrentFlights;if(s){u=u?`${u},${s}`:s;const e="prg-bngimg-t";-1===u.indexOf(e)&&(u+=","+e),!0===r&&(u=s)}return u&&l.push({key:n.t.fdhead,value:u}),c&&l.push({key:h.c,value:h.d}),a.b.IsBlendedEnterprise&&l.push({key:"audienceMode",value:"enterprise"}),l}function s(e=Object(h.j)(),t){return Object(r.a)(this,void 0,void 0,(function*(){const i={};if(e&&!(yield Object(h.g)())){const e=yield Object(h.e)(c.c,c.f,c.e);e&&e.token&&t?i[n.s.entAuthorization]=e.token:e&&e.token&&(i[n.s.authorization]="Bearer "+e.token)}if(!Object(v.a)()){const e=Object(b.a)().cookie;e&&(i.Cookie=e);const t=Object(b.a)().referer;t&&(i.Referer=t)}return i}))}function T(e,t){return u.a.isNonNullObject(e)&&u.a.isNonNullObject(e.sitePage)&&Object(y.a)(e.sitePage.page_product)&&Object(y.a)(e.sitePage.page_type)?e.sitePage.page_product+"-"+e.sitePage.page_type+(t?"-"+t:""):t}e.authenticationTicketType="10",e.signedInCookieNameHeader="signedInCookieName",e.userLocationHeader="user-location",e.serviceRequestOnComplete=function(e,t){return Object(r.a)(this,void 0,void 0,(function*(){try{const i=yield e();return t(),i}catch(e){throw t(),e}}))},e.getOneServiceParamsWithoutAuth=i,e.getOneServiceNonDynamicParamsWithoutAuth=function(e,t=!0){const i=Object(o.b)(),s=[{key:n.t.apiKey,value:i.OneServiceApiKey},{key:n.t.ocid,value:t?T(i.TrackInfo,e):e},{key:n.t.market,value:i.CurrentMarket}];return Object(h.j)()&&s.push({key:h.c,value:h.d}),s},e.getOneServiceParamsWithAuth=function(e=null,t,s=!0,r=null,a=!1){const c=Object(o.b)().AuthCookieName,d=[...i(e,t,s,r,a)];return c&&d.push({key:n.t.signInCookieName,value:c.toUpperCase()}),d},e.getOneServiceHeaders=s,e.getWinWidgetOneServiceHeaders=function(e,i=!1,s,a,c){var u;return Object(r.a)(this,void 0,void 0,(function*(){const r=Object(o.b)(),p=(null===(u=null==r?void 0:r.CurrentRequestTargetScope)||void 0===u?void 0:u.audienceMode)===m.a.Enterprise,h={};if(!e)return O.a.sendAppErrorEvent(Object.assign(Object.assign({},j.ic),{message:"Failed to retrieve user auth token and MUID from WDX client due to undefined widget instance",source:"OneSericeUtility",pb:Object.assign(Object.assign({},j.ic.pb),{widgetInstance:e,widgetInstanceId:s,windowsSessionId:a})})),h;let f;const v=Object(g.b)(e,p?d.b:d.c,p?d.f:d.g,p?d.d:d.e);t?f=yield v:[f,t]=yield Promise.all([v,Object(g.a)(e)]),f?(p&&i&&(h[n.s.entAuthorization]=f),p||(h[n.s.rpsToken]=f)):c&&O.a.sendAppErrorEvent(Object.assign(Object.assign({},j.hc),{message:"WDX Client failed to return user auth token",source:"OneSericeUtility",pb:Object.assign(Object.assign({},j.hc.pb),{widgetInstance:e,widgetInstanceId:s,windowsSessionId:a})}));const b=Object(l.b)();return t?(h[n.s.muid]=t,t!==b&&Object(d.a)(t)):b&&(h[n.s.muid]=b),h}))},e.getOneServiceFeedCallHeaders=function(e,t){return Object(r.a)(this,void 0,void 0,(function*(){const i=yield s(e,t),r=Object(o.b)(),a=r.ActivityId;return r.SendFeedCallActivityIdInHeader&&a&&(i[n.s.activityId]=a),i}))},e.getLocationParams=function(e,t){const i=Object(o.b)(),s=e||i.Latitude,r=t||i.Longitude;return s&&r?{key:n.t.location,value:`${s}|${r}`}:null},e.getOneServiceOCID=T,e.getBaseRequestData=function(t){return Object(r.a)(this,void 0,void 0,(function*(){return{headers:yield e.getOneServiceHeaders(),method:t}}))},e.getCommonParams=function(e,t=!1){return Object(a.a)().UserIsSignedIn?this.getOneServiceParamsWithAuth(Object(o.b)().UserId,e,t):this.getOneServiceParamsWithoutAuth(Object(o.b)().UserId,e,t)},e.getCommonParams2=function(e,t=!0,i=!1){return Object(f.e)()?this.getOneServiceParamsWithAuth(Object(o.b)().UserId,e,t,i):this.getOneServiceParamsWithoutAuth(Object(o.b)().UserId,e,t,i)},e.urlContainsOcidParam=function(e){if(!e)return!1;const t=e.split("?");if(t.length<2)return!1;const i=t[1].split("#")[0];return!!new p.a(i).get("ocid")},e.removeOcidFromUrl=function(e){if(!e)return e;const t=e.split("?");if(t.length<2)return e;const i=t[1].split("#")[0],s=new p.a(i);if(s.get("ocid")){s.delete("ocid");let t=e.replace(i,s.toString());return"?"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t}return e},e.removeOcidFromRiverCardProviderResponse=function(t){t&&t.cardMetadata&&t.cardMetadata.length&&t.cardMetadata.forEach(t=>{t.cardContent&&t.cardContent.destinationUrl?t.cardContent.destinationUrl=e.removeOcidFromUrl(t.cardContent.destinationUrl):t.subItems&&t.subItems.length&&t.subItems.forEach(t=>{t.cardContent&&t.cardContent.destinationUrl&&(t.cardContent.destinationUrl=e.removeOcidFromUrl(t.cardContent.destinationUrl))})})},e.removeOcidFromWindowsOneServiceResponse=function(t){t&&t.cards&&t.cards.forEach(t=>{t.subCards.forEach(t=>{t.url?t.url=e.removeOcidFromUrl(t.url):t.subCards&&t.subCards.forEach(t=>{t.url&&(t.url=e.removeOcidFromUrl(t.url))})})})}}(s||(s={}))},oKML:function(e,t,i){"use strict";var s=i("mr4r");t.a=function(e,t){return Object(s.a)(t,(function(t){return e[t]}))}},pMIE:function(e,t,i){"use strict";var s=i("/XsO"),r=i("eupA");var o=function(e){return Object(r.a)(Object(s.a)(e))},n=i("mOQN");var a=function(e){return Object(r.a)(Object(n.a)(e))},c=i("SEb4");t.a=function(e){return(Object(c.a)(e)?o:a)(e)}},rPvf:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var s=i("D57K"),r=i("HxRh"),o=i("tMmC"),n=i("y+Kz"),a=i("BQg2"),c=i("rvYQ"),d=i("VbA2"),l=i("zfSW"),u=i("I6Lx"),p=i("OTRt"),h=i("msIb"),g=i("6ADy"),f=i("KETb"),v=i("ac9z"),b=i("kN1G"),m=i("/+Un");class y{constructor(){this.cachedMetadata={}}get(e){const t=O(e);if(t)return this.cachedMetadata[t]}set(e,t){const i=O(e);i&&(this.cachedMetadata[i]=t)}}function O(e){if(e)return JSON.stringify(e)}var j=i("tERu"),T=i("ypwz"),w=i("u5KZ"),S=i("HDSB"),I=i("zJcZ");class C{constructor(e){this.config=e,this.responseCache=new y,this.requestPathWithoutFeedId="MSN/Feed/me",this.requestPathWithFeedId="MSN/Feed",this.requestPathForFeedLayout="MSN/FeedLayout"}fetch(e,t){return Object(s.a)(this,void 0,void 0,(function*(){let i=this.config.initialRequest;if(e&&(e.feedId||!i.feedId||e.nextPageUrl||(e.feedId=i.feedId),i=Object.assign(Object.assign({},i),e)),!i)return void w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.xf),{message:"default OneService fetch configuration was invalid"}));const l=this.responseCache.get(i);if(l)return l;const u=(null==e?void 0:e.forceEnterpriseCompliance)||Object(b.j)(),y=yield h.a.getOneServiceFeedCallHeaders(u);if(u&&!(null==y?void 0:y[n.s.authorization]))return;const O={credentials:"include",headers:y,method:"GET"},T=i.useNextPageUrl&&i.nextPageUrl,C=i.feedLayoutRequestType;let R;R=!T&&C?this.requestPathForFeedLayout:i.feedId?this.requestPathWithFeedId:this.requestPathWithoutFeedId;const F=Object(g.a)(R,null==e?void 0:e.overwriteBaseApiURL),k=Object(v.b)();if(T)this.requestQueryParams=new a.a(new URL(T).search),k>0&&this.requestQueryParams.set(v.a,k.toString()),c.a.SendFeedCallActivityIdInHeader||this.requestQueryParams.set(n.t.activityId,c.a.ActivityId);else{const{ocid:e,flightData:t,overwriteFlightData:s}=i,r=(yield Object(m.d)())===j.c.SignedIn?h.a.getOneServiceParamsWithAuth(c.a.UserId,e,!1,t,s):h.a.getOneServiceParamsWithoutAuth(c.a.UserId,e,!1,t,s,u);this.requestQueryParams=new a.a;for(let e=0;e<r.length;e++)this.requestQueryParams.set(r[e].key,r[e].value);if(C&&!i.start)this.requestQueryParams.set(n.t.feedLayoutRequestType,C);else if(!i.disableQueryType){const e=i.queryType||"myfeed";this.requestQueryParams.set(n.t.queryType,e)}if(this.requestQueryParams.set(n.t.responseSchema,i.disableFlatViewResponse?p.a.CardView:p.a.FlatView).set(n.t.wrapOData,"false").set(n.t.disableTypeSerialization,"true").set(n.t.timeOut,""+this.getRequestTimeout(i)).set(n.t.contentType,i.contentType).set(n.t.select,i.select),i.count&&this.requestQueryParams.set(n.t.top,""+i.count),this.tryAddQueryInterestParams(i)||this.requestQueryParams.set(n.t.ids,i.feedId).set(n.t.query,i.query),!C&&!i.disableLocation){const e=h.a.getLocationParams(i.latitude,i.longitude);e&&this.requestQueryParams.set(e.key,e.value)}i.start&&this.requestQueryParams.set(n.t.skip,""+i.start),i.infopaneItemCount&&(this.requestQueryParams.set(n.t.infopaneCount,""+i.infopaneItemCount),!1===i.complexInfopaneEnabled&&this.requestQueryParams.set(n.t.complexInfoPaneEnabled,"false")),k>0&&this.requestQueryParams.set(v.a,k.toString()),(i.useDelta||i.sessionId)&&(!1!==i.useDelta&&this.requestQueryParams.set(n.t.delta,"true"),i.sessionId&&this.requestQueryParams.set(n.t.session,i.sessionId))}let E,A,M,U;c.a.SendFeedCallActivityIdInHeader&&this.requestQueryParams.delete(n.t.activityId),F.search=this.requestQueryParams.toString();try{const e=Object(S.a)()?1e4:800,t=yield Object(f.b)(()=>Object(s.a)(this,void 0,void 0,(function*(){return yield Object(d.a)(decodeURIComponent(F.href),e,O)})),"OneServiceCardProvider.fetch");if(!t||!t.ok&&404!==t.status){M=t?t.status:null,U=t?t.statusText:null;const e=401===M?r.Eh:r.wf;return void w.a.sendAppErrorEvent(Object.assign(Object.assign({},e),{message:t?"OneService returned error response":"OneService response was null",pb:Object.assign(Object.assign({},e.pb),{fetchNetworkResponse:{activityId:c.a.ActivityId,requestUrl:F.href,statusCode:M,statusText:U}})}))}if(204===t.status||404===t.status?(E={feedItems:[]},M=t.status,U=t.statusText,w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.vf),{message:204===t.status?"Empty non first-page response":"Empty first-page response",pb:Object.assign(Object.assign({},r.vf.pb),{fetchNetworkResponse:{activityId:c.a.ActivityId,requestUrl:F.href,statusCode:M,statusText:U}})}))):E=yield t.json(),t.headers){t.headers.get("X-Statics-Fallback")&&w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.yf),{pb:Object.assign(Object.assign({},r.yf.pb),{customMessage:"Request URL: "+decodeURIComponent(F.href)}),message:"Fell back to static content on the feeds call"}));const e=t.headers.get("ddd-tmpl");w.a.addOrUpdateTmplString(e),A=t.headers.get("ddd-session-id");const i=t.headers.get(n.u.traceId);this.addOrUpdateIdxId(i)}}catch(e){return void w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.rf),{message:"Error while fetching OneService response",pb:Object.assign(Object.assign({},r.rf.pb),{customMessage:"Error: "+e,fetchNetworkResponse:{activityId:c.a.ActivityId,requestUrl:F.href}})}))}if(!E)return void w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.tf),{message:"Didn't get valid JSON from response.",pb:Object.assign(Object.assign({},r.tf.pb),{fetchNetworkResponse:{activityId:c.a.ActivityId,requestUrl:F.href}})}));const D=(this.requestQueryParams.get(n.t.feedLayoutRequestType)||"").toLowerCase(),L="tabriver"===D||"tabs"===D,{nextPageUrl:P,feedItems:q}=this.requestQueryParams.get(n.t.responseSchema)===p.a.CardView?Object(I.b)(E,L):E;if(!q)return void w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.sf),{message:"Didn't get valid feed items list from response.",pb:Object.assign(Object.assign({},r.sf.pb),{fetchNetworkResponse:{activityId:c.a.ActivityId,requestUrl:F.href,responseJson:JSON.stringify(E)}})}));if(!q.length&&!i.start)if(i.isSearchRequest)this.trackEmptyResponseForInterestSearch(i.feedId,i.query,F.href);else if(i.feedId){const{emptyResponseFeedIds:e}=this.config.initialRequest;t||i.feedId.startsWith("Q_")||e&&e.length&&-1!==e.indexOf(i.feedId)||this.trackEmptyResponseForXFeed(i.feedId,F.href)}else i.query?this.trackEmptyResponseForKidsMode(i.query,F.href):this.trackAppErrorHelper(r.qf,"OneService returned an empty feed for a myfeed request.",F.href,null,null,"",M,U);if(L)if("tabriver"===D){const e=q.find(e=>"tabbedInfopane"===e.type);e&&e.subItems&&e.subItems.length||w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.lh),{pb:Object.assign(Object.assign({},r.lh.pb),{feedData:JSON.stringify(E),fetchNetworkResponse:{activityId:c.a.ActivityId,requestUrl:F.href,responseJson:JSON.stringify(E)}}),message:"TabRiver request returned empty content for tabbed infopane card."}))}else if("tabs"===D){let e=!1;e=!q.length||-1!==q.findIndex(e=>"tabbedInfopane"!==e.type||!e.subItems||!e.subItems.length),e&&w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.mh),{pb:Object.assign(Object.assign({},r.mh.pb),{fetchNetworkResponse:{activityId:c.a.ActivityId,requestUrl:F.href,responseJson:JSON.stringify(E)}}),message:"Tabs request returned empty content for one or more tabbed infopane cards."}))}let x;if(q.length>=0?x=Object.assign(Object.assign({},i),{nextPageUrl:P,start:(i.start||0)+i.count}):o.a.log(`River has reached end of content stream. requested: ${i.count}, received: ${q.length}`),i.postRequestGrouping){const{start:e,count:t,type:s}=i.postRequestGrouping,r={type:s,subItems:q.splice(e,t)};q.splice(e,0,r)}const N={cardMetadata:q,nextPageRequest:x,sessionId:A};return this.responseCache.set(i,N),N}))}fetchFromWebWorker(e,t=1e3,i){return Object(S.a)()?Object(l.b)({id:e},t).then(e=>{const t=e.payload;if(!e.fetched||!t||!t.feedData)return null;t.responseSchema===p.a.CardView&&(t.feedData=Object(I.b)(t.feedData,t.isTabbedInfopaneResponse));const{nextPageUrl:s,feedItems:r=[]}=t.feedData;let o,n=this.config.initialRequest;if(i&&(n=Object.assign(Object.assign({},n),i)),s&&r.length&&(o=Object.assign(Object.assign({},n),{start:(n.start||0)+n.count,nextPageUrl:s})),n.postRequestGrouping){const{start:e,count:t,type:i}=n.postRequestGrouping,s={type:i,subItems:r.splice(e,t)};r.splice(e,0,s)}const a=t.traceId;return this.addOrUpdateIdxId(a),{cardMetadata:r,nextPageRequest:o,sessionId:t.sessionId}}):Promise.resolve(null)}clearCache(){this.responseCache=new y}getRequestTimeout(e){const{timeoutMs:t,isSearchRequest:i,query:s,customFeedTimeoutMs:r}=e;return i&&s&&r?r:t}tryAddQueryInterestParams(e){if(!e.useVerticalAsInterest&&!e.useCategoryAsInterest)return!1;const t=(e.useVerticalAsInterest?u.b.ClientSettings.verticalKey:u.b.ClientSettings.categoryKey)||"",i=e.verticalCategoryKeyToInterestMapping[t.toLowerCase()],s=i||"news";return this.requestQueryParams.set(n.t.query,encodeURIComponent(s)).set(n.t.source,e.contentSource),i||e.useCategoryAsInterest&&!t||w.a.sendAppErrorEvent(Object.assign(Object.assign({},r.uf),{message:"Failed to get content",pb:Object.assign(Object.assign({},r.uf.pb),{customMessage:`Failed to get content for VerticalKey:${c.a.HostPage.verticalKey} | CategoryKey:${c.a.HostPage.categoryKey}. Loading fallback views river with ${s} content.`})})),!0}trackAppErrorHelper(e,t,i,s,r,o,n,a){let d="";s&&(d+=`Feed id: ${s}. `),r&&(d+=`Feed query: ${r}. `),w.a.sendAppErrorEvent(Object.assign(Object.assign({},e),{message:t,pb:Object.assign(Object.assign({},e.pb),{customMessage:d,fetchNetworkResponse:{activityId:c.a.ActivityId,requestUrl:i,responseJson:o,statusCode:n,statusText:a}})}))}trackEmptyResponseForKidsMode(e,t){this.trackAppErrorHelper(r.Lb,"OneService returned an empty feed for kids mode",t,null,e)}trackEmptyResponseForXFeed(e,t){this.trackAppErrorHelper(r.Kb,"OneService returned an empty feed for an x-feed page.",t,e,null)}trackEmptyResponseForInterestSearch(e,t,i){e?this.trackAppErrorHelper(r.Mb,"OneService returned an empty feed for a user searched xfeed.",i,e,null):this.trackAppErrorHelper(r.Nb,"OneService returned an empty feed for a user query.",i,null,t)}addOrUpdateIdxId(e){if(c.a.AppType===T.a.EdgeChromium&&e){const t=w.a.getPageMetadata().getJoinId(n.l),i=t?`${t},${e}`:e;w.a.addOrUpdateJoinIdProperty("IDXId",i)}}}C.providerName="OneService"},rfxS:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));const s=1},"uH2+":function(e,t,i){"use strict";var s;i.d(t,"a",(function(){return s})),function(e){e.Followed="followed",e.Unfollowed="unfollowed",e.Locked="locked",e.None="none"}(s||(s={}))},zI0X:function(e,t,i){"use strict";var s=i("QjXF");t.a=function(e,t){return!!(null==e?0:e.length)&&Object(s.a)(e,t,0)>-1}},zJcZ:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return c}));var s=i("LJMo"),r=i("HxRh"),o=i("u5KZ");function n(e,t=!1,i=!1){if(!e)return e;if(Array.isArray(e)){if(!e.length)return e;e=e[0]}if(!e||!e.subCards||!Array.isArray(e.subCards))return e;const s=e.subCards.map(e=>a(e,t,i));return!e.subCards.length||s&&s.length&&e.subCards.length===s.length||o.a.sendAppErrorEvent(Object.assign(Object.assign({},r.bb),{message:"Mapper returned invalid data",pb:Object.assign(Object.assign({},r.bb.pb),{customMessage:`Count mismatch - expected count [${e.subCards.length}] - actual count [${s.length}]`})})),{feedItems:s,nextPageUrl:e.nextPageUrl}}function a(e,t=!1,i=!1){if(!e)return{};if(e.type===s.a.EsportsLiveStream||e.type===s.a.EsportsHighlight||e.type===s.a.LocalNews||e.type===s.a.LocalNewsFeed||e.type===s.a.MyBriefRiverCard||e.type===s.a.ShoppingMerchantCategoryDeals||e.type===s.a.SportsMatch||e.type===s.a.SportsOlympics||e.type===s.a.StockQuote||e.type===s.a.StockQuote_spotlight||e.type===s.a.TopStories||e.type===s.a.TrafficDelays||e.type===s.a.Upsell||e.type===s.a.WeatherSummary||e.type===s.a.WeatherSummary_spotlight||e.type===s.a.WorkHeadlines)return e;if(e.subCards)return t?{subItems:e.subCards.map(e=>a(e)),type:e.type||"tabbedInfopane"}:function(e){const{type:t,title:i}=e,s=e.subCards.map(e=>a(e));return{type:t,subItems:s,metadata:{title:i}}}(e);if(e.type===s.a.ExternalLink)return function(e){const{id:t,type:i,images:s,url:r,category:o,feed:n={},title:a="",abstract:c=""}=e,d=u(s)||{},p=l(r),{uiHint:h,actionText:g}=e.uiMetadata||{};return{id:t,type:i,metadata:{abstractLength:c.length,title:a,titleLength:a.length,category:o||p[4],subCategory:"other",primaryImage:{height:d.height,width:d.width,url:d.url},locale:p[3],url:r,abstract:c,uiHint:h,actionText:g,feed:{id:n.id},kicker:[{feedName:n.feedName}]}}}(e);if(e.type===s.a.WebContent&&!i)return function(e){const{id:t,type:i,images:s,url:r,category:o,locale:n,reactionSummary:a,commentSummary:c,tag:h,abstract:g="",feed:f={},title:v="",provider:b={},actions:m=[],isBreaking:y=0,externalVideoFiles:O={},publishedDateTime:j,colorSamples:T,dataUrl:w,sourceId:S,financeMetadata:I,isLocalContent:C}=e,R=u(s)||{},F=l(r);return{id:t,type:i,metadata:{abstract:g,abstractLength:g.length,titleLength:v.length,category:o||F[4],subCategory:F[5],publishedDateTime:j,externalVideoFiles:O,locale:n,feed:{id:f.id},kicker:[f],actions:m.map(e=>p[e]||e),reactionSummary:a,commentSummary:c,primaryImage:{height:R.height,width:R.width,url:R.url},url:r,title:v,provider:{name:b.name,logo:{url:b.logoUrl}}},cardContent:{id:t,type:i,title:v,abstract:g,isBreaking:y,tags:[h||{}],provider:{id:b.id,name:b.name,logoUrl:b.logoUrl,image:{alt:b.name,src:b.logoUrl}},category:{product:o,label:void 0},locale:n,images:[{id:d(R.url),height:R.height,width:R.width,caption:R.title,focalRegion:R.focalRegion,attribution:R.attribution,url:R.url,colorSamples:R.colorSamples}],colorSamples:T,videoFiles:O,publishedDateTime:j,kicker:v,sourceHref:w,destinationUrl:r,sourceId:S,financeMetadata:I,isLocalContent:C}}}(e);const{type:r,isBreaking:o,locale:n,category:h,images:g,topics:f=[],dataUrl:v,publishedDateTime:b,id:m,url:y,abstract:O="",title:j="",provider:T={},feed:w={},actions:S=[],externalVideoFiles:I,reactionSummary:C,commentSummary:R,engagementSummary:F,sourceId:k,financeMetadata:E,topComments:A,colorSamples:M,isLocalContent:U}=e,D=u(g)||{},L=I||{},P=f.find(e=>e.feedId===w.id&&e.locale===n),q=l(y);let x=d(T.logoUrl);return!x&&T.logo&&T.logo.url&&(x=d(T.logo.url)),{id:m,type:r,metadata:{abstractLength:O.length,titleLength:j.length,category:h||q[4],subCategory:q[5],primaryImage:{height:D.height,width:D.width},locale:n,feed:{id:w.id},kicker:[w],actions:S.map(e=>p[e]||e),reactionSummary:C,commentSummary:R,engagementSummary:F,topComments:A},cardContent:{id:m,type:c(r),title:j,uriTitle:q[6],abstract:O,isBreaking:o||0,tags:[P||{}],provider:{id:T.id,name:T.name,logo:{id:x},logoUrl:T.logoUrl||T.logo&&T.logo.url,subscribable:!1},category:{product:h,label:void 0},locale:n,images:[{id:d(D.url),height:D.height,width:D.width,caption:D.title,focalRegion:D.focalRegion,attribution:D.attribution,source:D.source,url:D.url,colorSamples:D.colorSamples}],colorSamples:M,videoFiles:L,publishedDateTime:b,kicker:j,sourceHref:v,destinationUrl:y,sourceId:k,financeMetadata:E,isLocalContent:U}}}function c(e){switch(e){case"article":return"ArticlePreview";case"video":return"VideoPreview";case"slideshow":return"SlideshowPreview";case"webcontent":return"WebContentPreview";default:return""}}function d(e){if(!e)return"";if(e.includes("bing.com/th"))return;const t=e.split("/");return u(t)&&t[t.length-1].replace(".img","")}function l(e){return e?e.split("/"):[]}function u(e=[],t=0){return e[t]}const p={liked:"like",unliked:"unlike",saved:"save"}}}]);